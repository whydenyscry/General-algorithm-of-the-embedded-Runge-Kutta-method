function [t, zsol, dzdt_eval, stats] = odeEmbeddedSolvers(odefun, tspan, incond, options)
% odeEmbeddedSolvers Solve non-stiff ODEs using high-order adaptive Runge-Kutta methods.
%   [t, z] = odeEmbeddedSolvers(odefun, tspan, z0) integrates the system
%   of differential equations z' = f(t,z) from time tspan(1) to tspan(2)
%   with initial conditions z0. odefun is a function handle. For a scalar t
%   and a column vector z, odefun(t,z) must return a column vector of
%   derivatives f(t,z).
%
%   [t, z, dzdt] = odeEmbeddedSolvers(...) also returns the history of
%   derivatives dzdt at each time step.
%
%   [..., stats] = odeEmbeddedSolvers(...) returns a structure stats with
%   computational cost statistics (number of steps, failed steps, etc.).
%
%   [...] = odeEmbeddedSolvers(..., name, value) specifies optional
%   name-value pair arguments:
%
%     'Method'       - Integration method. Specifies the explicit Runge-Kutta pair.
%                      Options:
%                        Order 5:
%                          "Tsit5(4)7*" - Tsitouras 5(4). Modern improvement over
%                                         Dormand-Prince (higher efficiency).
%                          "RK5(4)7*M"  - Dormand-Prince 5(4). Classic standard.
%
%                        Order 6 (Verner IIIXb):
%                          "IIIXb+6(5)9*" (Default) - Robust variant.
%                          "IIIXb-6(5)9*"           - Efficient variant.
%
%                        Order 7 (Verner IIa1):
%                          "IIa1+7(6)10" - Robust.
%                          "IIa1-7(6)10", "IIa1-7(6)10M" - Efficient.
%
%                        Order 8 (Verner IIa):
%                          "IIa+8(7)13" - Robust. High stability.
%                          "IIa-8(7)13" - Efficient. Fastest for smooth high-precision
%                                         problems (e.g., orbital mechanics).
%
%                        Order 9 (Verner IIa):
%                          "IIa+9(8)16" (Robust), "IIa-9(8)16" (Efficient).
%
%                      Legend: "*" denotes FSAL property (saves 1 eval/step).
%                              "+" denotes Robust, "-" denotes Efficient.
%
%     'ATol'         - Absolute tolerance (scalar). Default: 1e-10.
%     'RTol'         - Relative tolerance (scalar). Default: 1e-10.
%
%     'SafetyFactor' - Safety factor for step size prediction. Default: 0.8.
%                      (Lower values like 0.8 increase stability on stiff problems).
%
%     'MinStepSize'  - Minimum allowed step size. Default: 1e-16.
%     'MaxStepSize'  - Maximum allowed step size. Default: 1.0.
% 
% References
% Dormand, J. R., & Prince, P. J. (1980). A family of embedded Runge-Kutta formulae. Journal of Computational and Applied Mathematics, 6(1), 19–26. https://doi.org/10.1016/0771-050x(80)90013-3
% Tsitouras, C. (2011). Runge–Kutta pairs of order 5(4) satisfying only the first column simplifying assumption. Computers & Mathematics With Applications, 62(2), 770–775. https://doi.org/10.1016/j.camwa.2011.06.002
% Verner, J. H. (1978). Explicit Runge–Kutta Methods with Estimates of the Local Truncation Error. SIAM Journal on Numerical Analysis, 15(4), 772–790. https://doi.org/10.1137/0715051
% Verner, J. H. (1993). Differentiable interpolants for High-Order Runge–Kutta Methods. SIAM Journal on Numerical Analysis, 30(5), 1446–1466. https://doi.org/10.1137/0730075
% Verner, J. H. (2009). Numerically optimal Runge–Kutta pairs with interpolants. Numerical Algorithms, 53(2–3), 383–396. https://doi.org/10.1007/s11075-009-9290-3
% Verner, J. H. (n.d.). Jim Verner's Refuge for Runge–Kutta Pairs. Simon Fraser University. https://www.sfu.ca/~jverner/

arguments
    odefun function_handle
    tspan (1,2) double
    incond 
    options.Method (1,1) string {mustBeMember(options.Method, ["Tsit5(4)7*" "RK5(4)7*M" "IIIXb-6(5)9*" "IIIXb+6(5)9*" "IIa1-7(6)10" "IIa1-7(6)10M" "IIa1+7(6)10" "IIa-8(7)13" "IIa+8(7)13" "IIa-9(8)16" "IIa+9(8)16"])} = "IIIXb+6(5)9*"
    options.ATol (1,1) double = 1e-10
    options.RTol (1,1) double = 1e-10
    options.MinStepSize (1,1) double = 1e-16
    options.MaxStepSize (1,1) double = 1
    options.SafetyFactor (1,1) double = 0.8 
    options.MaxGrowth (1,1) double = 5.0   
    options.MinGrowth (1,1) double = 0.2    
end

switch options.Method
    case "Tsit5(4)7*"
        c_vector = [ ...
            0;
            0.161;
            0.327;
            0.9;
            0.9800255409045096857298102862870245954942137979563024768854764293221195950761080302604;
            1;
            1] ;
        
        A_matrix = zeros(7,7);
        
        A_matrix(2,1) = 0.161;
        
        A_matrix(3,1) = -0.008480655492356988544426874250230774675121177393430391537369234245294192976164141156943;
        A_matrix(3,2) = 0.3354806554923569885444268742502307746751211773934303915373692342452941929761641411569;
        
        A_matrix(4,1) = 2.897153057105493432130432594192938764924887287701866490314866693455023795137503079289;
        A_matrix(4,2) = -6.359448489975074843148159912383825625952700647415626703305928850207288721235210244366;
        A_matrix(4,3) = 4.362295432869581411017727318190886861027813359713760212991062156752264926097707165077;
        
        A_matrix(5,1) = 5.325864828439256604428877920840511317836476253097040101202360397727981648835607691791;
        A_matrix(5,2) = -11.74888356406282787774717033978577296188744178259862899288666928009020615663593781589;
        A_matrix(5,3) = 7.495539342889836208304604784564358155658679161518186721010132816213648793440552049753;
        A_matrix(5,4) = -0.09249506636175524925650207933207191611349983406029535244034750452930469056411389539635;
        
        A_matrix(6,1) = 5.861455442946420028659251486982647890394337666164814434818157239052507339770711679748;
        A_matrix(6,2) = -12.92096931784710929170611868178335939541780751955743459166312250439928519268343184452;
        A_matrix(6,3) = 8.159367898576158643180400794539253485181918321135053305748355423955009222648673734986;
        A_matrix(6,4) = -0.07158497328140099722453054252582973869127213147363544882721139659546372402303777878835;
        A_matrix(6,5) = -0.02826905039406838290900305721271224146717633626879770007617876201276764571291579142206;
        
        A_matrix(7,1) = 0.09646076681806522951816731316512876333711995238157997181903319145764851595234062815396;
        A_matrix(7,2) = 0.01;
        A_matrix(7,3) = 0.4798896504144995747752495322905965199130404621990332488332634944254542060153074523509;
        A_matrix(7,4) = 1.379008574103741893192274821856872770756462643091360525934940067397245698027561293331;
        A_matrix(7,5) = -3.290069515436080679901047585711363850115683290894936158531296799594813811049925401677;
        A_matrix(7,6) = 2.324710524099773982415355918398765796109060233222962411944060046314465391054716027841;

        b_vector = [ ...
            0.09646076681806522951816731316512876333711995238157997181903319145764851595234062815396;
            0.01;
            0.4798896504144995747752495322905965199130404621990332488332634944254542060153074523509;
            1.379008574103741893192274821856872770756462643091360525934940067397245698027561293331;
            -3.290069515436080679901047585711363850115683290894936158531296799594813811049925401677;
            2.324710524099773982415355918398765796109060233222962411944060046314465391054716027841;
            0] ;

        b_hat_vector = [ ...
            0.09468075576583945237382945810437480985952548450114660586326944637766925714617764855396;
            0.0091835655403432530967763639366453137598137462409840952389059395329229552472536069;
            0.4877705284247615707855642599631228241516691959761363774365216240304071651579539683509;
            1.234297566930478985655109673884237654035539930748192848315425833500484878378046293331;
            -2.707712349983525454881109975059321670689605166938197378763992255714444407154924201677;
            1.866628418170587035753719399566211498666255505244122593996591602841258328965762127841;
            1/66] .';
            
        p_order = 5;
        isFSAL = true;

    case "RK5(4)7*M"
        c_vector = [...
            0; 
            1/5; 
            3/10; 
            4/5; 
            8/9; 
            1; 
            1];
        
        A_matrix = zeros(7,7);
        
        A_matrix(2,1) = 1/5;
        
        A_matrix(3,1) = 3/40;
        A_matrix(3,2) = 9/40;
        
        A_matrix(4,1) = 44/45;
        A_matrix(4,2) = -56/15;
        A_matrix(4,3) = 32/9;
        
        A_matrix(5,1) = 19372/6561;
        A_matrix(5,2) = -25360/2187;
        A_matrix(5,3) = 64448/6561;
        A_matrix(5,4) = -212/729;
        
        A_matrix(6,1) = 9017/3168;
        A_matrix(6,2) = -355/33;
        A_matrix(6,3) = 46732/5247;
        A_matrix(6,4) = 49/176;
        A_matrix(6,5) = -5103/18656;

        A_matrix(7,1) = 35/384;
        A_matrix(7,2) = 0;
        A_matrix(7,3) = 500/1113;
        A_matrix(7,4) = 125/192;
        A_matrix(7,5) = -2187/6784;
        A_matrix(7,6) = 11/84;
        
        b_vector = [35/384; 0; 500/1113; 125/192; -2187/6784; 11/84; 0];

        b_hat_vector = [5179/57600; 0; 7571/16695; 393/640; -92097/339200; 187/2100; 1/40];
        
        p_order = 5;
        isFSAL = true;
    case "IIIXb-6(5)9*"
        c_vector = [ ...
            0;
            3/50;
            1439/15000;
            1439/10000;
            4973/10000;
            389/400;
            1999/2000;
            1;
            1] ;

        A_matrix = zeros(9,9);

        A_matrix(2,1) = 3/50;

        A_matrix(3,1) = 519479/27000000;
        A_matrix(3,2) = 2070721/27000000;

        A_matrix(4,1) = 1439/40000;
        A_matrix(4,2) = 0;
        A_matrix(4,3) = 4317/40000;

        A_matrix(5,1) = 109225017611/82828840000;
        A_matrix(5,2) = 0;
        A_matrix(5,3) = -417627820623/82828840000;
        A_matrix(5,4) = 43699198143/10353605000;

        A_matrix(6,1) = -8036815292643907349452552172369/191934985946683241245914401600;
        A_matrix(6,2) = 0;
        A_matrix(6,3) = 246134619571490020064824665/1543816496655405117602368;
        A_matrix(6,4) = -13880495956885686234074067279/113663489566254201783474344;
        A_matrix(6,5) = 755005057777788994734129/136485922925633667082436;

        A_matrix(7,1) = -1663299841566102097180506666498880934230261/30558424506156170307020957791311384232000;
        A_matrix(7,2) = 0;
        A_matrix(7,3) = 130838124195285491799043628811093033/631862949514135618861563657970240;
        A_matrix(7,4) = -3287100453856023634160618787153901962873/20724314915376755629135711026851409200;
        A_matrix(7,5) = 2771826790140332140865242520369241/396438716042723436917079980147600;
        A_matrix(7,6) = -1799166916139193/96743806114007800;

        A_matrix(8,1) = -832144750039369683895428386437986853923637763/15222974550069600748763651844667619945204887;
        A_matrix(8,2) = 0;
        A_matrix(8,3) = 818622075710363565982285196611368750/3936576237903728151856072395343129;
        A_matrix(8,4) = -9818985165491658464841194581385463434793741875/61642597962658994069869370923196463581866011;
        A_matrix(8,5) = 31796692141848558720425711042548134769375/4530254033500045975557858016006308628092;
        A_matrix(8,6) = -14064542118843830075/766928748264306853644;
        A_matrix(8,7) = -1424670304836288125/2782839104764768088217;

        A_matrix(9,1) = 382735282417/11129397249634;
        A_matrix(9,2) = 0;
        A_matrix(9,3) = 0;
        A_matrix(9,4) = 5535620703125000/21434089949505429;
        A_matrix(9,5) = 13867056347656250/32943296570459319;
        A_matrix(9,6) = 626271188750/142160006043;
        A_matrix(9,7) = -51160788125000/289890548217;
        A_matrix(9,8) = 163193540017/946795234;

        b_vector = [ ...
            382735282417/11129397249634;
            0;
            0;
            5535620703125000/21434089949505429;
            13867056347656250/32943296570459319;
            626271188750/142160006043;
            -51160788125000/289890548217;
            163193540017/946795234;
            0] ;

        b_hat_vector = [ ...
            273361583/5567482366;
            0;
            0;
            1964687500000/8727630165387;
            596054687500/1269637976277;
            12740367500/15795556227;
            0;
            -4462730789736252634813752317/7350663039626676022821734166;
            441454562788983500/7763730504400359099] ;

        p_order = 6;
        isFSAL = true;

    case "IIIXb+6(5)9*"
        c_vector = [0; 9/50; 1/6; 1/4; 53/100; 3/5; 4/5; 1; 1];
        
        A_matrix = zeros(9,9);
        
        A_matrix(2,1) = 9/50;
        
        A_matrix(3,1) = 29/324; 
        A_matrix(3,2) = 25/324;
        
        A_matrix(4,1) = 1/16;   
        A_matrix(4,3) = 3/16; 
       
        A_matrix(5,1) = 79129/250000;
        A_matrix(5,3) = -261237/250000;
        A_matrix(5,4) = 19663/15625;
        
        A_matrix(6,1) = 1336883/4909125;
        A_matrix(6,3) = -25476/30875;
        A_matrix(6,4) = 194159/185250;
        A_matrix(6,5) = 8225/78546;
        
        A_matrix(7,1) = -2459386/14727375;
        A_matrix(7,3) = 19504/30875;
        A_matrix(7,4) = 2377474/13615875;
        A_matrix(7,5) = -6157250/5773131;
        A_matrix(7,6) = 902/735;
       
        A_matrix(8,1) = 2699/7410;
        A_matrix(8,3) = -252/1235;
        A_matrix(8,4) = -1393253/3993990;
        A_matrix(8,5) = 236875/72618;
        A_matrix(8,6) = -135/49;
        A_matrix(8,7) = 15/22;

        b_vector = [11/144; 0; 0; 256/693; 0; 125/504; 125/528; 5/72; 0];        
        A_matrix(9, :) = b_vector.';

        b_hat_vector = [28/477; 0; 0; 212/441; -312500/366177; 2125/1764; 0; -2105/35532; 2995/17766];      
        p_order = 6;
        isFSAL = true;

    case "IIa1-7(6)10"        
        c_vector = [ ...
            0;
            1/200;
            49/450;
            49/300;
            911/2000;
            3480084980/5709648941;
            221/250;
            37/40;
            1;
            1;] .';

        A_matrix = zeros(10,10);

        A_matrix(2,1) = 1/200;

        A_matrix(3,1) = -4361/4050;
        A_matrix(3,2) = 2401/2025;

        A_matrix(4,1) = 49/1200;
        A_matrix(4,2) = 0;
        A_matrix(4,3) = 49/400;

        A_matrix(5,1) = 2454451729/3841600000;
        A_matrix(5,2) = 0;
        A_matrix(5,3) = -9433712007/3841600000;
        A_matrix(5,4) = 4364554539/1920800000;

        A_matrix(6,1) = -6187101755456742839167388910402379177523537620/2324599620333464857202963610201679332423082271;
        A_matrix(6,2) = 0;
        A_matrix(6,3) = 27569888999279458303270493567994248533230000/2551701010245296220859455115479340650299761;
        A_matrix(6,4) = -37368161901278864592027018689858091583238040000/4473131870960004275166624817435284159975481033;
        A_matrix(6,5) = 1392547243220807196190880383038194667840000000/1697219131380493083996999253929006193143549863;

        A_matrix(7,1) = 11272026205260557297236918526339/1857697188743815510261537500000;
        A_matrix(7,2) = 0;
        A_matrix(7,3) = -48265918242888069/1953194276993750;
        A_matrix(7,4) = 26726983360888651136155661781228/1308381343805114800955157615625;
        A_matrix(7,5) = -2090453318815827627666994432/1096684189897834170412307919;
        A_matrix(7,6) = 1148577938985388929671582486744843844943428041509/1141532118233823914568777901158338927629837500000;

        A_matrix(8,1) = 1304457204588839386329181466225966641/108211771565488329642169667802016000;
        A_matrix(8,2) = 0;
        A_matrix(8,3) = -1990261989751005/40001418792832;
        A_matrix(8,4) = 2392691599894847687194643439066780106875/58155654089143548047476915856270826016;
        A_matrix(8,5) = -1870932273351008733802814881998561250/419326053051486744762255151208232123;
        A_matrix(8,6) = 1043329047173803328972823866240311074041739158858792987034783181/510851127745017966999893975119259285040213723744255237522144000;
        A_matrix(8,7) = -311918858557595100410788125/3171569057622789618800376448;

        A_matrix(9,1) = 17579784273699839132265404100877911157/1734023495717116205617154737841023480;
        A_matrix(9,2) = 0;
        A_matrix(9,3) = -18539365951217471064750/434776548575709731377;
        A_matrix(9,4) = 447448655912568142291911830292656995992000/12511202807447096607487664209063950964109;
        A_matrix(9,5) = -65907597316483030274308429593905808000000/15158061430635748897861852383197382130691;
        A_matrix(9,6) = 273847823027445129865693702689010278588244606493753883568739168819449761/136252034448398939768371761610231099586032870552034688235302796640584360;
        A_matrix(9,7) = 694664732797172504668206847646718750/1991875650119463976442052358853258111;
        A_matrix(9,8) = -19705319055289176355560129234220800/72595753317320295604316217197876507;

        A_matrix(10,1) = -511858190895337044664743508805671/11367030248263048398341724647960;
        A_matrix(10,2) = 0;
        A_matrix(10,3) = 2822037469238841750/15064746656776439;
        A_matrix(10,4) = -23523744880286194122061074624512868000/152723005449262599342117017051789699;
        A_matrix(10,5) = 10685036369693854448650967542704000000/575558095977344459903303055137999707;
        A_matrix(10,6) = -6259648732772142303029374363607629515525848829303541906422993/876479353814142962817551241844706205620792843316435566420120;
        A_matrix(10,7) = 17380896627486168667542032602031250/13279937889697320236613879977356033;
        A_matrix(10,8) = 0;
        A_matrix(10,9) = 0;

        b_vector = [ ...
            96762636172307789/2051985304794103980;
            0;
            0;
            312188947591288252500000/1212357694274963646019729;
            13550580884964304000000000000/51686919683339547115937980629;
            72367769693133178898676076432831566019684378142853445230956642801/475600216991873963561768100160364792981629064220601844848928537580;
            1619421054120605468750/3278200730370057108183;
            -66898316144057728000/227310933007074849597;
            181081444637946577/2226845467039736466;
            0] ;

        b_hat_vector = [ ...
            117807213929927/2640907728177740;
            0;
            0;
            4758744518816629500000/17812069906509312711137;
            1730775233574080000000000/7863520414322158392809673;
            2682653613028767167314032381891560552585218935572349997/12258338284789875762081637252125169126464880985167722660;
            40977117022675781250/178949401077111131341;
            0;
            0;
            2152106665253777/106040260335225546] ;

        p_order = 7;
        isFSAL = false;

    case "IIa1-7(6)10M"
        c_vector = [ ...
            0;
            69/1000;
            59/500;
            177/1000;
            501/1000;
            2315802800/2992844303;
            497/500;
            499/500;
            1;
            1] ;

        A_matrix = zeros(10,10);

        A_matrix(2,1) = 69/1000;

        A_matrix(3,1) = 59/3450;
        A_matrix(3,2) = 3481/34500;

        A_matrix(4,1) = 177/4000;
        A_matrix(4,2) = 0;
        A_matrix(4,3) = 531/4000;

        A_matrix(5,1) = 10238937/13924000;
        A_matrix(5,2) = 0;
        A_matrix(5,3) = -39407157/13924000;
        A_matrix(5,4) = 2259009/870250;

        A_matrix(6,1) = -15383063799457947774162786564155688537984607600/1259275502826931493365457235462458740508569749;
        A_matrix(6,2) = 0;
        A_matrix(6,3) = 13636329640266997061898077655506436320000000/279280439748709579366923316802496948438361;
        A_matrix(6,4) = -7849857552131913028846468911879258886700000000/203595440576809283358487097949020275411565169;
        A_matrix(6,5) = 26558492028140990975913366297943027060000000/9767434236233022212257209238002409076050383;

        A_matrix(7,1) = 1693631672689148171299746335956403/15557685084971650515961800000000;
        A_matrix(7,2) = 0;
        A_matrix(7,3) = -12886387619105287/29798414847430;
        A_matrix(7,4) = 166792207691509721753786653837972/484985800197446538759747217875;
        A_matrix(7,5) = -8612993672719804438712813/419115390059666125531071;
        A_matrix(7,6) = 8711496371958872516559009756267806714231541783/7119664157324003895788891707124597610200000000;

        A_matrix(8,1) = 482598318810345340147549821069890673511/4252885096093048652227854892200000000;
        A_matrix(8,2) = 0;
        A_matrix(8,3) = -335837225452900919/744960371185750;
        A_matrix(8,4) = 4314718692790068364584679604398347481136/12035031825554428462193835378358401375;
        A_matrix(8,5) = -19520073049463013534179746511408887/910006917045880487844897509844735;
        A_matrix(8,6) = 213273724212084347100323074348539394670238604390859671493442803321/167397801251712736685049467180589771772846483007282174245800000000;
        A_matrix(8,7) = -3550009354482848439238/1632793352473881246850155;

        A_matrix(9,1) = 464627742666489022675930201058294647073/4015810365668612776899447493147250400;
        A_matrix(9,2) = 0;
        A_matrix(9,3) = -1244924757503648062100000/2708339114775423710831;
        A_matrix(9,4) = 864659299303807467036797204818807058621375000/2365342873784133828255245219573718795686067;
        A_matrix(9,5) = -414659562054100142126373639303068923975000/18947103805180679925384667287569757463641;
        A_matrix(9,6) = 251512033288886919998655372996651140090744320679272221558349952682043771161/193661758784000518862549108190096025969740958697864544201340884431322887200;
        A_matrix(9,7) = -129993524671997661561380436281250/2444084122502261426468505184352693297;
        A_matrix(9,8) = -330048664133494745911800776343750/106519032367013306849702395825384439;

        A_matrix(10,1) = 470079564369459040686787340931565597/3786249933535897266309463814153100;
        A_matrix(10,2) = 0;
        A_matrix(10,3) = -1439402335766809850000/2918307634665215021;
        A_matrix(10,4) = 1217576093985000201402477212355810625000/3104409301326893443345355830426079157;
        A_matrix(10,5) = -964786499051902131132330939617300000/41078490380170414512884911711048923;
        A_matrix(10,6) = 105909114887436922177247742512269809363763568654627062084851/77741562653892131345714509407181067729754534520235410312700;
        A_matrix(10,7) = -129993524671997661561380436281250/18434960824828884218598340292834789;
        A_matrix(10,8) = 0;
        A_matrix(10,9) = 0;

        b_vector = [ ...
            110449732827920922049/2139039437196626445600;
            0;
            0;
            82144253503717584250000000/296852662604261569174926543;
            28701859979839412750000000/85063334157510472676763963;
            2000756020505118480302890049859609915307579431466395123771510448993/10616972547296396564204658747724522321501545545777484342713104600800;
            101994151411635671875000/4156013744827048489581;
            -32907155770141921875000/478218947736615415477;
            778034793098369351/17516858519634453;
            0] ;

        b_hat_vector = [ ...
            31168104595177243/612378882678679200;
            0;
            0;
            14430837870576125000000/51653499670134255990069;
            8023020477538375000000/24450512836306545753597;
            1013340986447375509449239341420768103367507272384401717/4520370232598781381352724440907944812168778918885975200;
            467526300172843750000/593716249261006927083;
            0;
            0;
            -1676706483576682/2502408359947779] ;

        p_order = 7;
        isFSAL = false;

    case "IIa1+7(6)10"
        c_vector = [0 1/200 49/450 49/300 91/200 34704460/57271701 167/200 183/200 1 1] .';
        
        A_matrix = zeros(10,10);
        
        A_matrix(2,1) = 1/200;
        
        A_matrix(3,1) = -4361/4050;
        A_matrix(3,2) = 2401/2025;
        
        A_matrix(4,1) = 49/1200;
        A_matrix(4,3) = 49/400;
        
        A_matrix(5,1) = 1781/2800;
        A_matrix(5,3) = -13689/5600;
        A_matrix(5,4) = 507/224;
        
        A_matrix(6,1) = -275776923568321554889485313326460/108782544039075797415588764982099;
        A_matrix(6,3) = 9576001512158705648097438730000/929765333667314507825544999847;
        A_matrix(6,4) = -22178538465642954902290458689600/2789296001001943523476634999541;
        A_matrix(6,5) = 12323686750109283453854913779200/15540363434153685345084109283157;
        
        A_matrix(7,1) = 8221508014471276464993/8206108584945090400000;
        A_matrix(7,3) = -9852144759099/2364568872400;
        A_matrix(7,4) = 15322550932778398907299/3996134347464283007200;
        A_matrix(7,5) = -18338463121898520004/36506562121215938675;
        A_matrix(7,6) = 23340475544602125119307511373519383499/34957329425893779598660175543672800000;
        
        A_matrix(8,1) = 81088643022740545033730780169/2975182110231937140152800000;
        A_matrix(8,3) = -2837794586103/67559110640;
        A_matrix(8,4) = -14167575606881316095038341141/1344719188593468553337836000;
        A_matrix(8,5) = 2395552232834276839307772/29760062864388068268875;
        A_matrix(8,6) = -4076715891031001341580357765362043260356514682697/60535801523558513633981092635987721507186400000;
        A_matrix(8,7) = 36551527355459957808/2801171464968864455;
        
        A_matrix(9,1) = -3347747115771808477876752833599/1101327591307901549464211073280;
        A_matrix(9,3) = 1214704878477625125/119815105452943264;
        A_matrix(9,4) = -65581118617864038124456452415/10200342297342072539428709672;
        A_matrix(9,5) = -133373082911575479273298406095/84070826916189821955373830704;
        A_matrix(9,6) = 622515683654039386383701463758952267447736841050281950137693/328994218860140584540186142455568117669077094653332432085760;
        A_matrix(9,7) = 46169188671551441399013763125/2343692704156841275628930358208;
        A_matrix(9,8) = 18880867865877597493091875/3469664148196911643475533504;
        
        A_matrix(10,1) = -74309815528722196127526037/51427190037752065777334640;
        A_matrix(10,3) = 913722369253875/113761793498234;
        A_matrix(10,4) = -440658227159292602060396890/58109996881684093545238767;
        A_matrix(10,5) = 37290888293935763341814380/10411746696360295961914239;
        A_matrix(10,6) = -645152888113581065780360392105179310452496326847/264735425121804814898131042131367320451487910960;
        A_matrix(10,7) = 473757486190086838681892500/556321100802942639360459887;
        
        b_vector = [9420080774669597/198627609019792680 0 0 18658605936510000/72821569629535727 296950875175030000/1101802245630054969 18875276980274212686824835566143151189850553896330009/148780947139609706104394157596648357994575577036224440 18663850606812500/74993696164706319 179884749312500/58508928482581269 349315176247648/7273791403140339 0] .';
        
        b_hat_vector = [7362904929137/155056681514280 0 0 7505178129270000/29317774785916981 1851744839320000/6843492208882329 750882778189818437512810407839645051128089/6004363295715536270735789992319176322209240 27902602073000000/110704980052661709 0 0 331667036438/6791588611709] .';
        
        p_order = 7;
        isFSAL = false;

    case"IIa-8(7)13"        
        c_vector = [ ...
            0;
            1/20;
            341/3200;
            1023/6400;
            39/100;
            93/200;
            31/200;
            943/1000;
            7067558016280/7837150160667;
            909/1000;
            47/50;
            1;
            1] ;

        A_matrix = zeros(13,13);

        A_matrix(2,1) = 1/20;

        A_matrix(3,1) = -7161/1024000;
        A_matrix(3,2) = 116281/1024000;

        A_matrix(4,1) = 1023/25600;
        A_matrix(4,2) = 0;
        A_matrix(4,3) = 3069/25600;

        A_matrix(5,1) = 4202367/11628100;
        A_matrix(5,2) = 0;
        A_matrix(5,3) = -3899844/2907025;
        A_matrix(5,4) = 3982992/2907025;

        A_matrix(6,1) = 5611/114400;
        A_matrix(6,2) = 0;
        A_matrix(6,3) = 0;
        A_matrix(6,4) = 31744/135025;
        A_matrix(6,5) = 923521/5106400;

        A_matrix(7,1) = 21173/343200;
        A_matrix(7,2) = 0;
        A_matrix(7,3) = 0;
        A_matrix(7,4) = 8602624/76559175;
        A_matrix(7,5) = -26782109/689364000;
        A_matrix(7,6) = 5611/283500;

        A_matrix(8,1) = -1221101821869329/690812928000000;
        A_matrix(8,2) = 0;
        A_matrix(8,3) = 0;
        A_matrix(8,4) = -125/2;
        A_matrix(8,5) = -1024030607959889/168929280000000;
        A_matrix(8,6) = 1501408353528689/265697280000000;
        A_matrix(8,7) = 6070139212132283/92502016000000;

        A_matrix(9,1) = -1472514264486215803881384708877264246346044433307094207829051978044531801133057155/1246894801620032001157059621643986024803301558393487900440453636168046069686436608;
        A_matrix(9,2) = 0;
        A_matrix(9,3) = 0;
        A_matrix(9,4) = -5172294311085668458375175655246981230039025336933699114138315270772319372469280000/124619381004809145897278630571215298365257079410236252921850936749076487132995191;
        A_matrix(9,5) = -12070679258469254807978936441733187949484571516120469966534514296406891652614970375/2722031154761657221710478184531100699497284085048389015085076961673446140398628096;
        A_matrix(9,6) = 780125155843893641323090552530431036567795592568497182701460674803126770111481625/183110425412731972197889874507158786859226102980861859505241443073629143100805376;
        A_matrix(9,7) = 664113122959911642134782135839106469928140328160577035357155340392950009492511875/15178465598586248136333023107295349175279765150089078301139943253016877823170816;
        A_matrix(9,8) = 10332848184452015604056836767286656859124007796970668046446015775000000/1312703550036033648073834248740727914537972028638950165249582733679393783;

        A_matrix(10,1) = -29055573360337415088538618442231036441314060511/22674759891089577691327962602370597632000000000;
        A_matrix(10,2) = 0;
        A_matrix(10,3) = 0;
        A_matrix(10,4) = -20462749524591049105403365239069/454251913499893469596231268750;
        A_matrix(10,5) = -180269259803172281163724663224981097/38100922558256871086579832832000000;
        A_matrix(10,6) = 21127670214172802870128286992003940810655221489/4679473877997892906145822697976708633673728000;
        A_matrix(10,7) = 318607235173649312405151265849660869927653414425413/6714716715558965303132938072935465423910912000000;
        A_matrix(10,8) = 212083202434519082281842245535894/20022426044775672563822865371173879;
        A_matrix(10,9) = -2698404929400842518721166485087129798562269848229517793703413951226714583/469545674913934315077000442080871141884676035902717550325616728175875000000;

        A_matrix(11,1) = -2342659845814086836951207140065609179073838476242943917/1358480961351056777022231400139158760857532162795520000;
        A_matrix(11,2) = 0;
        A_matrix(11,3) = 0;
        A_matrix(11,4) = -996286030132538159613930889652/16353068885996164905464325675;
        A_matrix(11,5) = -26053085959256534152588089363841/4377552804565683061011299942400;
        A_matrix(11,6) = 20980822345096760292224086794978105312644533925634933539/3775889992007550803878727839115494641972212962174156800;
        A_matrix(11,7) = 890722993756379186418929622095833835264322635782294899/13921242001395112657501941955594013822830119803764736;
        A_matrix(11,8) = 161021426143124178389075121929246710833125/10997207722131034650667041364346422894371443;
        A_matrix(11,9) = 300760669768102517834232497565452434946672266195876496371874262392684852243925359864884962513/4655443337501346455585065336604505603760824779615521285751892810315680492364106674524398280000;
        A_matrix(11,10) = -31155237437111730665923206875/392862141594230515010338956291;

        A_matrix(12,1) = -2866556991825663971778295329101033887534912787724034363/868226711619262703011213925016143612030669233795338240;
        A_matrix(12,2) = 0;
        A_matrix(12,3) = 0;
        A_matrix(12,4) = -16957088714171468676387054358954754000/143690415119654683326368228101570221;
        A_matrix(12,5) = -4583493974484572912949314673356033540575/451957703655250747157313034270335135744;
        A_matrix(12,6) = 2346305388553404258656258473446184419154740172519949575/256726716407895402892744978301151486254183185289662464;
        A_matrix(12,7) = 1657121559319846802171283690913610698586256573484808662625/13431480411255146477259155104956093505361644432088109056;
        A_matrix(12,8) = 345685379554677052215495825476969226377187500/74771167436930077221667203179551347546362089;
        A_matrix(12,9) = -3205890962717072542791434312152727534008102774023210240571361570757249056167015230160352087048674542196011/947569549683965814783015124451273604984657747127257615372449205973192657306017239103491074738324033259120;
        A_matrix(12,10) = 40279545832706233433100438588458933210937500/8896460842799482846916972126377338947215101;
        A_matrix(12,11) = -6122933601070769591613093993993358877250/1050517001510235513198246721302027675953;

        A_matrix(13,1) = -618675905535482500672800859344538410358660153899637/203544282118214047100119475340667684874292102389760;
        A_matrix(13,2) = 0;
        A_matrix(13,3) = 0;
        A_matrix(13,4) = -4411194916804718600478400319122931000/40373053902469967450761491269633019;
        A_matrix(13,5) = -16734711409449292534539422531728520225/1801243715290088669307203927210237952;
        A_matrix(13,6) = 135137519757054679098042184152749677761254751865630525/16029587794486289597771326361911895112703716593983488;
        A_matrix(13,7) = 38937568367409876012548551903492196137929710431584875/340956454090191606099548798001469306974758443147264;
        A_matrix(13,8) = -6748865855011993037732355335815350667265625/7002880395717424621213565406715087764770357;
        A_matrix(13,9) = -1756005520307450928195422767042525091954178296002788308926563193523662404739779789732685671/348767814578469983605688098046186480904607278021030540735333862087061574934154942830062320;
        A_matrix(13,10) = 53381024589235611084013897674181629296875/8959357584795694524874969598508592944141;
        A_matrix(13,11) = 0;
        A_matrix(13,12) = 0;

        b_vector = [ ...
            44901867737754616851973/1014046409980231013380680;
            0;
            0;
            0;
            0;
            791638675191615279648100000/2235604725089973126411512319;
            3847749490868980348119500000/15517045062138271618141237517;
            -13734512432397741476562500000/875132892924995907746928783;
            12274765470313196878428812037740635050319234276006986398294443554969616342274215316330684448207141/489345147493715517650385834143510934888829280686609654482896526796523353052166757299452852166040;
            -9798363684577739445312500000/308722986341456031822630699;
            282035543183190840068750/12295407629873040425991;
            -306814272936976936753/1299331183183744997286;
            0] ;

        b_hat_vector = [ ...
            10835401739407019406577/244521829356935137978320;
            0;
            0;
            0;
            0;
            13908189778321895491375000/39221135527894265375640567;
            73487947527027243487625000/296504045773342769773399443;
            68293140641257649609375000/15353208647806945749946119;
            22060647948996678611017711379974578860522018208949721559448560203338437626022142776381/1111542009262325874512959185795727215759010577565736079641376621381577236680929558640;
            -547971229495642458203125000/23237214025700991642563601;
            0;
            0;
            -28735456870978964189/79783493704265043693] ;

        p_order = 8;
        isFSAL = false;



    case "IIa+8(7)13"
        c_vector = [0 1/4 86021/762000 86021/508000 53/125 509/1000 867/1000 3/20 295159845764/416264491649 8/25 9/20 1 1] .';
        
        A_matrix = zeros(13,13);
        
        A_matrix(2,1) = 1/4;
        
        A_matrix(3,1) = 25374388559/290322000000;
        A_matrix(3,2) = 7399612441/290322000000;
        
        A_matrix(4,1) = 86021/2032000;
        A_matrix(4,3) = 258063/2032000;
        
        A_matrix(5,1) = 394117287349/924951555125;
        A_matrix(5,3) = -1478808184872/924951555125;
        A_matrix(5,4) = 1476870356896/924951555125;
        
        A_matrix(6,1) = 21806069/429936000;
        A_matrix(6,4) = 2085253894/8198887125;
        A_matrix(6,5) = 67122964561/329119824000;
        
        A_matrix(7,1) = -10767669849309/37129416272000;
        A_matrix(7,4) = 107549272780798434/80010624633743375;
        A_matrix(7,5) = -1571425354197/548533040000;
        A_matrix(7,6) = 195974150961/73190382500;
        
        A_matrix(8,1) = 122914197/1247416480;
        A_matrix(8,5) = 2834577/12772576;
        A_matrix(8,6) = -1123911/6195548;
        A_matrix(8,7) = 1003245/91667332;
        
        A_matrix(9,1) = 7516815761873698650240937021297888610305781198156454914018066425686713809124/19417750920086037142705440148991358353524951455336635926349428617092008016799;
        A_matrix(9,4) = -2970280712345026029784493078033500603558797778620788610891609609625083520000000/2059197881322255811366824379732129118957063276855086357832879720044283034195609;
        A_matrix(9,5) = 160883051099229570661648871967605637311447402857798976770144318499344176200/55373838844007112802284696674027443630749586849658020349496486226959885797;
        A_matrix(9,6) = -531291044569132007849980767445890096567679581535833821522948115776782916800/286600138103969709516639731800408929385020510549016787456022559956334619913;
        A_matrix(9,7) = 92917760295507691123384296375592154091398238056386167422408760067912000/663525387387781548392930054085313627947883220329590736767284727992793459;
        A_matrix(9,8) = 16582882008248100072444682934459438760351720266822956376058566080/28953624935338209620540938361130162616618239541632595427443431123;
        
        A_matrix(10,1) = -397907419247815925921130059686865048509124/2467734205602744466122026313943800290709375;
        A_matrix(10,4) = -12397380504027867540933244272640/71497487771289358131961402817451;
        A_matrix(10,5) = -938215172932764769802614036208/720988934849815411624418693625;
        A_matrix(10,6) = 39294182008628611505961825730565883738506112/34530663960302355453963385168366837619171375;
        A_matrix(10,7) = -44522287344548287709730039702917122688/1402380579847472465941191457456761953225;
        A_matrix(10,8) = 20222100246339043804092120397184/21662367405707901792558292907875;
        A_matrix(10,9) = -30521958981544768864151899144647092370777642374348985368652529884/364283329166067503011761408054691133551081505869170977618646228125;
        
        A_matrix(11,1) = -7874248153103427073301520825686819245245713313/410128949126757953376487799591079982676499635200;
        A_matrix(11,4) = 592147767606693369421771800000/2166590538523919943392769782347;
        A_matrix(11,5) = -3777316336297553135210313111/5593126282471295314419732896;
        A_matrix(11,6) = 160775746506894169042900490691204481389877265439/470767315337957626238784466576517627715500536844;
        A_matrix(11,7) = -507593940096706904938228151863398894238905405/7470102369519587845109530946292707809479335476;
        A_matrix(11,8) = 173196146788876378135182681744256899/1793073867682496036448646518502714730;
        A_matrix(11,9) = 937132687483187059957479559988037034595389945431346986697458481846645979573026347/7071054501415007346897024777503547537721817297910549006214731593062974677881100800;
        A_matrix(11,10) = 116416656136756811965545/315877857843708025406464;
        
        A_matrix(12,1) = 28191405932827173126309408200664465069287507375903/46277040828099807659589313374497236005056822803488;
        A_matrix(12,4) = -429380072388144504981858700675520000000/188940382517997566021881003968356031669;
        A_matrix(12,5) = 24173887609985281514926963208103700/5080791111711202068770238453613777;
        A_matrix(12,6) = -54881449674479480016593038012420742831966782264181600/9949308922521596315581680829335134273237927944004721;
        A_matrix(12,7) = 970969892075126686370480622782649944320946827348000/3347483649309697775724736894621937483768621235854151;
        A_matrix(12,8) = 77411823900067580361972977027037723040/136014860952969119034946902128158999209;
        A_matrix(12,9) = 656779806953299263849114640553093566236946159841995197013788762083697980273440465097410146645645/828556489672666107963907105193770544832899849879697116662334249174938654251472014083110713914032;
        A_matrix(12,10) = 3147129425650261440272289698280046875/20338543888980253307598069078752387872;
        A_matrix(12,11) = 425854850025102447819650719213220000/263691965699784622774911587349396263;
        
        A_matrix(13,1) = 3621456146894606285894995339383850874108700148373/4081168693163363596994878822807031005774876048608;
        A_matrix(13,4) = -3817583686059663366913679467944640000000/1283023117642128560298752783599596583383;
        A_matrix(13,5) = 193234496869635405437524415902310900/34501742641572006835386893540142539;
        A_matrix(13,6) = -87974988257716022018037206149145819377007277738400/14871674463411999056342756887683215806741009406229;
        A_matrix(13,7) = 3275133743198491987936602396440511473300401684000/14866908561378488620343856456061248578257652060133;
        A_matrix(13,8) = 8526827543558748199980436728262708480/83965981332240915696885276969279079833;
        A_matrix(13,9) = 39009210105998257555064429930449313140180415214883261536546755024187088643232941505/33878790250537583879968593309051059917530985063051045330469429477091985229650821808;
        A_matrix(13,10) = 266248736648182734031056196146328125/137973433143769650633804707559140704;
        
        b_vector = [105711409411029096011/2363345366733216286848 0 0 0 0 49144903996079337500000000000/313203740909075359159534015851 122908398183230837500000000000/665774200882383246774037878723 14734515405327276428000/65439093723444914604579 98855236015768950806532226039371426875067857784942240050406497922541356709067743917330653/668183874060994347945818441723205177438829897987551586564757651033104640132059340614221120 80375815959623894921875/1056804190408540040777856 48020889007901260000/391135894718289455007 1146762646211206909/27426666521711241540 0] .';
        
        b_hat_vector = [415143901557332051/9054963090931863168 0 0 0 0 1392529918457821250000000000/5308537981509751850161593489 2142381651020498750000000000/11176065722246241552561786933 4735428542080120856000/21813031241148304868193 1360794378607602525113722425939330174725374220595898325328629456869721330363/10682792599936408020924171586589409694572260337238697644239411829708789571520 9357212880829926171875/81292630031426156982912 0 0 7787234078438942063/191986665651978690780] .';
        
        p_order = 8;
        isFSAL = false;

    case "IIa-9(8)16"
        c_vector = [ ...
            0;
            1731/50000;
            7630049/53810000 - (983539/53810000)*sqrt(6);
            22890147/107620000 - (2950617/107620000)*sqrt(6);
            561/1000;
            387/1000 - (129/2000)*sqrt(6);
            387/1000 + (129/2000)*sqrt(6);
            129/200;
            387/800;
            6757/100000;
            1/4;
            1427971650951258372/2166662646162554701;
            4103/5000;
            2253/2500;
            1;
            1] ;

        A_matrix = zeros(16,16);

        A_matrix(2,1) = 1731/50000;

        A_matrix(3,1) = -177968356965557/1002427673820000 + (14180534491313/250606918455000)*sqrt(6);
        A_matrix(3,2) = 64021741529527/200485534764000 - (7504450763411/100242767382000)*sqrt(6);

        A_matrix(4,1) = 22890147/430480000 - (2950617/430480000)*sqrt(6);
        A_matrix(4,2) = 0;
        A_matrix(4,3) = 68670441/430480000 - (8851851/430480000)*sqrt(6);

        A_matrix(5,1) = 592203994261020339/513126355505556250 + (730386990293623641/2052505422022225000)*sqrt(6);
        A_matrix(5,2) = 0;
        A_matrix(5,3) = -8712153884182794903/2052505422022225000 - (2843421359195851533/2052505422022225000)*sqrt(6);
        A_matrix(5,4) = 1873698362223295443/513126355505556250 + (528258592225556973/513126355505556250)*sqrt(6);

        A_matrix(6,1) = 11380823631/157617812000 - (339148869/39404453000)*sqrt(6);
        A_matrix(6,2) = 0;
        A_matrix(6,3) = 0;
        A_matrix(6,4) = -(2355345717024309/58864341808507450)*sqrt(6) + 16193232887091831/58864341808507450;
        A_matrix(6,5) = 165912282616977/4179075230308000 - (33181894472511/2089537615154000)*sqrt(6);

        A_matrix(7,1) = 26523528363/231790900000 + (863255358/123138915625)*sqrt(6);
        A_matrix(7,2) = 0;
        A_matrix(7,3) = 0;
        A_matrix(7,4) = -38208748178016484817787/842517966262441068418750 - (86118788556282369822807/842517966262441068418750)*sqrt(6);
        A_matrix(7,5) = 92362336407446913/290322814529044000 - (232039320950012997/2467743923496874000)*sqrt(6);
        A_matrix(7,6) = -362925891/1690350537500 + (857800423623/3380701075000)*sqrt(6);

        A_matrix(8,1) = 43/600;
        A_matrix(8,2) = 0;
        A_matrix(8,3) = 0;
        A_matrix(8,4) = 0;
        A_matrix(8,5) = 0;
        A_matrix(8,6) = 43/150 + (43/2400)*sqrt(6);
        A_matrix(8,7) = -(43/2400)*sqrt(6) + 43/150;

        A_matrix(9,1) = 7353/102400;
        A_matrix(9,2) = 0;
        A_matrix(9,3) = 0;
        A_matrix(9,4) = 0;
        A_matrix(9,5) = 0;
        A_matrix(9,6) = 22833/102400 + (8901/204800)*sqrt(6);
        A_matrix(9,7) = -(8901/204800)*sqrt(6) + 22833/102400;
        A_matrix(9,8) = -3483/102400;

        A_matrix(10,1) = 376708742472214988700853/7788456028125000000000000;
        A_matrix(10,2) = 0;
        A_matrix(10,3) = 0;
        A_matrix(10,4) = 0;
        A_matrix(10,5) = 0;
        A_matrix(10,6) = 187914666753956840195279/2596152009375000000000000 - (210440846556290693268911/15576912056250000000000000)*sqrt(6);
        A_matrix(10,7) = (210440846556290693268911/15576912056250000000000000)*sqrt(6) + 187914666753956840195279/2596152009375000000000000;
        A_matrix(10,8) = -18552667221896744226647/865384003125000000000000;
        A_matrix(10,9) = -3167799860072183913409/30423656359863281250000;

        A_matrix(11,1) = -426968570497/54394415898750 - (92754382349/12087647977500)*sqrt(6);
        A_matrix(11,2) = 0;
        A_matrix(11,3) = 0;
        A_matrix(11,4) = 0;
        A_matrix(11,5) = 0;
        A_matrix(11,6) = 1/30;
        A_matrix(11,7) = -2865012129681958/114898584332330625 - (12962517687655099/229797168664661250)*sqrt(6);
        A_matrix(11,8) = 4389715333607/309890657317500 + (92754382349/11477431752500)*sqrt(6);
        A_matrix(11,9) = (371017529396/9306344041875)*sqrt(6) + 4990058173976/83757096376875;
        A_matrix(11,10) = 1099523524595993125000/6257667909869756018891 + (100957348037989687500/6257667909869756018891)*sqrt(6);

        A_matrix(12,1) = 18382031104798403869938539009154656587521498573595595063164077882800315372787284683238439478955141517997198007108623761931447163756/13974256944499724344918960993890933614161025322970450047932688998095008528620821239604734608111291769444706187497807869179550841329375 + (407885778185158609210793892517582595305896470756467612636796259611491408260896413446883450891351622914818800693274034252252905536/28084926388601226073624096169175002956970191576455110633226765141161372294098693275117181239385312198137508846535933127837167926875)*sqrt(6);
        A_matrix(12,2) = 0;
        A_matrix(12,3) = 0;
        A_matrix(12,4) = 0;
        A_matrix(12,5) = 0;
        A_matrix(12,6) = -333881311789849411971573472868128281438202210721723123251742145367734582887577395547778228760174068758086134389952015563403904/2270872004608103037127689848604039623086639035441372934050180593816493796129405349914148981460714202232988727738778494557727635 + (4819272892477768171373308666720689121421091953625792970278044071549950640195056472955523769829034800621890424847009130000000/23162894447002650978702436455761204155483718161502003927311842056928236720519934569124319610899284862776485022935540644488821877)*sqrt(6);
        A_matrix(12,7) = 169845085565361336805556009296394374527636952379388961026066628725155521832762086875632366996477567928657535912191396155566765457826139904/1593979913718173260623679425966077497797978183146596135797795272107637620098614087434873732933937315094489187314474045293119200999609586875*sqrt(6) -136666607496463622270135608863772076443625468798139480390426740993024803946981763209348364716108721312822619845726151693667598437699964416/3719286465342404274788585327254180828195282427342057650194855634917821113563432870681372043512520401887141437067106105683944802332422369375;
        A_matrix(12,8) = 5610987899273278525411960528081442902198567594809764379756195673673265700551076812883925583370253765702553235594764427173637673766208/92881598198144033018278804740626334135423356791639598109358867770361609232846012626732332450844264293840456574956036349633197336361875 - (5587476413495323413846491678323049250765705078855720721052003556321800113162964567765526724539063327600257543743479921263738432/365303089362201664516413596925286161494473575337115296250511752859728108868696929614024803255122785403232359817965288739565550625)*sqrt(6);
        A_matrix(12,9) = 54598539818083615233566148602203244896696958910734339754065270985433507945162707737759469214674480807272210648148477499238783276259328/301247919092298852634886875129959310794662932014184499827145075851637298698312074030567479239502011693447423026416040794479934024058125 - (6526172450962537747372702280281321524894343532103481802188740153783862532174342615150135214261625966637100811092384548036046488576/86490932843037281836028387921320502668579653176624892284566487468170341285762869374265713247057712228954184044334206372230816544375)*sqrt(6);
        A_matrix(12,10) = -8108825145085088104344721048166325225173729495689364696426720161112012414227752328969720658987315654179873760357725235734000399440000000/265558296661064021061274102756797754810572081529546692522040189640618206693081506133206500662983001047298787619827411375675716583283801757*sqrt(6) + 9391667348404584010955422210328707125006120661611061908889750805619418785820948002455890360939221912190524731087070645107486913457760000000/58157266968773020612419028503738708303515285854970725662326801531295387265784849843172223645193277229358434488742203091272981931739152584783;
        A_matrix(12,11) = 123461712659887915177271339396606860810479028777869348014870450606260914019560285661288212498128400476015695960341952/281629106670320674754245209358840703704235147307838896741075511220826056829047205614324978253226176275078922716132461;

        A_matrix(13,1) = -56042772675322042139227629978042586330633622706053363946766144416933631/58808540772323190525590122613223430507352118534557342666015625000000000 + (281404579734699232141455524604487724159024972527/1478009944832743180452316204077188415527343750000)*sqrt(6);
        A_matrix(13,2) = 0;
        A_matrix(13,3) = 0;
        A_matrix(13,4) = 0;
        A_matrix(13,5) = 0;
        A_matrix(13,6) = -1027163900229750356561238237947225332675621517/179261894431132664078747698292867431640625000 - (2745292391641202525373103979336813513372321/11702216468464340311060649744558385937500000)*sqrt(6);
        A_matrix(13,7) = -157229999853748227305165773364426925282378072238332930121/36699907367985458573273204094330716033963413238525390625 + (5757606442802795095318986067317837904184278650664590252101/3523191107326604023034227593055748739260487670898437500000)*sqrt(6);
        A_matrix(13,8) = -9311448168593934146015965019904013602133802943325818346622781285907057/4255970849010124217193135449668739985401313363005576159362792968750000 - (844213739204097696424366573813463172477074917581/4210188359946578336976868164966163024902343750000)*sqrt(6);
        A_matrix(13,9) = 885774233856672590222951867695327816457340130391639153070521335485617578/301098541380295011015469248465465290112505656143757799934635162353515625 - (281404579734699232141455524604487724159024972527/284481916364737983221402322504830303192138671875)*sqrt(6);
        A_matrix(13,10) = 315479116729780153956412124052199685097744239386639023787359107959254802182/134481850506505848012587842215515574380212543200894932329128471154748828125 -  (2940396453647872276646068776592292229737651937934623/7345465058781983710795837429530784777245286520703125)*sqrt(6);
        A_matrix(13,11) = 2250996163406545378616532039018846586217631599453822541/382491303797095993563304148204275636433504028320312500;
        A_matrix(13,12) = 2689340957307691853294902388334454003959378146957529866233529251986359392336044151708949720958809747970514366293458424272174024493/  959516386019578808500569114780871708466894752280482835105408027815194895319055443842782227102120493960805649575561796875000000000;

        A_matrix(14,1) =  47342003848024391498707976847688893013083074441159779465719863625051668939887702630319/44802546873926050730401222636656855760802419993852060264615320801485392456054687500000-866369530987077991125562402829092187100493209601/3325522375873672156017711459173673934936523437500*6^(1/2);
        A_matrix(14,2) =  0;
        A_matrix(14,3) =  0;
        A_matrix(14,4) =  0;
        A_matrix(14,5) =  0;
        A_matrix(14,6) =  871779321807802447463310035318238762878527157/134446420823349498059060773719650573730468750+107641268480999396081848975271849857994818/1097082793918531904161935913552348681640625*6^(1/2);
        A_matrix(14,7) =  496103786351862292800034805114190705484800743513354117014/110099722103956375719819612282992148101890239715576171875-1329938412606197485769312599390307351191540891599374831099/660598332623738254318917673697952888611341438293457031250*6^(1/2);
        A_matrix(14,8) =  40774077277747636354598451708891165494123131383777235229538611989392175193285994266471/15264290546248162101058985941588079518256741255377031736357946125713524703979492187500+123767075855296855875080343261298883871499029943/451091609994276250390378731960660324096679687500*6^(1/2);
        A_matrix(14,9) =  -10522038608500556459828649038302068473735749030796372764961618751973793724796364606986664/3899417425005422254034574000397382862235892829653375835197340918271556055507659912109375+3465478123948311964502249611316368748401972838404/2560337247282641848992620902543472728729248046875*6^(1/2);
        A_matrix(14,10) =  -27843764471262693189365201135620670490328475323282820219474851621693895769527094334687108984/12257041066285164222002594300605593929434139193022166317802121412999357024704596261133984375+574774300271998598683873114105472016699241495055292/1049352151254569101542262489932969253892183788671875*6^(1/2);
        A_matrix(14,11) =  -34241134351848245624232809437676889009431930503529853032576417589898516/5613347824358651981100985009024281007603230062439942682713165283203125;
        A_matrix(14,12) =  -3432044375893932378102368568052286501033850910516999202088532705211633432793920547702800961532438008401883737341854688972639605334600163938610268855705742764072609/1143174106341682260971647690410567292143926198650927778920823267461111371275907599801714870165813394147519068210931766844494994616580258435518181434575195312500000;
        A_matrix(14,13) =  4746930876023919335079451612726717649218264199984/18592065538407049755200144388134089346432755594877;

        A_matrix(15,1) = -25188329249258825443748527038142409879923012133738985313265430932280250855708601/11370641325574469312056961874077298550827642308774647316995717036347558064286250 + (1234273058981860170179592598535508631343082535549881956/2105633771469628744518390642968552144069898845895808125)*sqrt(6);
        A_matrix(15,2) = 0;
        A_matrix(15,3) = 0;
        A_matrix(15,4) = 0;
        A_matrix(15,5) = 0;
        A_matrix(15,6) = -54821142119685055562477216205428613949905430396088/3959439837009461289085587746748097947393101278095 - (1511276753825982856072891469504471256664975925000/40386286337496505148672995016830599063409633036569)*sqrt(6);
        A_matrix(15,7) = -60922424274061599918603524049390657305431262635197540405697952/6484861747489032169774584624759953148531564032417461909516875 + (84558575751635978733109961893984238786929550462615375699341616/19454585242467096509323753874279859445594692097252385728550625)*sqrt(6);
        A_matrix(15,8) = -116118147575045169733222875835719955334334798191459879782123534889390467935109772/8810626901954835245672275131295870892503713957512170681453300814988417642493125 - (176324722711694310025656085505072661620440362221411708/285619406719829107485771207042040133465420149964555625)*sqrt(6);
        A_matrix(15,9) = 17769448722513898342276837490665097286927607247073335618566987143467294900183033216/2551217008137889615056342146084561867122485163596619283719957742418751029506356875 - (19748368943709762722873481576568138101489320568798111296/6484554262322259071286545935997129135111813687175650625)*sqrt(6);
        A_matrix(15,10) = 97659266139124074818193264801929547781659926543786381510190954184218570746215033823993530000000/18560076654469706205963482908787056850812308205603127326855360961727608242796551101182080033599 -  (85297084611782122474911131363078900058888025224607913745000000/69210659450201393843166746722954036326338355649915383851733911)*sqrt(6);
        A_matrix(15,11) = 473389749049752963256114649231353822492912259509649519870869750525/35412440882360341799798842428365422941216508121322622479260846291;
        A_matrix(15,12) = 33351439245158438248073494056784144097872912773415904536400728387690334563968394114702414108807505158106385116468732853458202899966748488718531545706559142895903144848764637/  2316611025327287427714802011322252886090793904989900621592365627649097578102163572190502232425490606773312310665593424982745744299371285598588298606088543376742054644818966;
        A_matrix(15,13) = -38714992656958413389743252726016897599283911682945255636643554687500000/48540494926971587499294589382572212036169135429877901702347521300421767;
        A_matrix(15,14) = 14800250200940323717124616175641261235119295795768814717803955078125/33565577125141877760287380588632421223433194078156948298488471160489;

        A_matrix(16,1) = 2305785696086397561080858186939897173645641331085041313944389849986584101287/617508244345282265819087370078275122671246164669900462139876057008239440000 - (85404623305589712632165905233974183137607899140719/124822287169084833758410283469525117460541643292500)*sqrt(6);
        A_matrix(16,2) = 0;
        A_matrix(16,3) = 0;
        A_matrix(16,4) = 0;
        A_matrix(16,5) = 0;
        A_matrix(16,6) = 102903996961580448264190625267026062654799259083/5046398084890004857481629999673320438819484730 + (41320925487304219313300272052128374567081128125/51473260465878049546312625996667868475958744246)*sqrt(6);
        A_matrix(16,7) = 62798443349876457506718920843975661399949564598018488144466/4132553498782573324058263582553715220777051359780141380625 - (72308807081932961554425711089716771013571419950657300729103/12397660496347719972174790747661145662331154079340424141875)*sqrt(6);
        A_matrix(16,8) = 1794909142126482564390848522924225553221469019751470544959297614654661293377/52596481193994264435601626109752988674679691644275456716633975785978672500 + (12200660472227101804595129319139169019658271305817/16931561456559959115207709344056578263397760602500)*sqrt(6);
        A_matrix(16,9) = -2775244732780109667342845612394739319115662636371477300455747022423270475907256/228417153675584029725018045422706955827996328208181619436454383447149337555625 + (341618493222358850528663620935896732550431596562876/96101338378773357469245211954911505447551097205625)*sqrt(6);
        A_matrix(16,10) = -27680554659769016623530979176727448251292244310769996015342190819068970556083063125000/3299557777429648960576561382256606844677258438797072955341581354051375036522231471437 +  (4426552127579895373479670356100179759944766558141730312500/3077113738667320707748877199804636746494977000658967987677)*sqrt(6);
        A_matrix(16,11) = -292603171929706291053929402159930330736639136252680853622275/15473622826279161150227076887290262443510550964275858143964;
        A_matrix(16,12) = -9815717129569106988569302193220999343824932084582093647596086931754666098662594153095258988516305165794739744873539829069617203523509136682216933020431/  286476991170934153076146641094402171801937250068596542931028678669501762253287693294397689327797388113854588113430063939405071979092547998950955940992;
        A_matrix(16,13) = 2729491144709837905799148766650782532906050298971406518524169921875/2158115888622139473142775812109447802920656149243127309253686951469;
        A_matrix(16,14) = 0;
        A_matrix(16,15) = 0;

        b_vector = [8198160366203173411119943711500331/561057579384085860167277847128765528;
            0;
            0;
            0;
            0;
            0;
            0;
            -455655493073428838813281446213740000000/1163808011150910561240464225837312497869;
            19965163648706008081135075746915614720000000/86394404190537086868394686205782432516544599;
            89231107919981418705566970804343750000000000000000000000/699979870988335674445594679856445060562597693583175985391;
            47104273954945906713184913871143492/209684639122339601934631113492763467;
            20845004421404500464010584740796750650832176798370383084226351294730731196673647311062330972740734737279503119387627146381678677156136042524139311907482802844083/36670849891136373020238225328265100250605144718501926305140966586758054847604681466336103169284755987753542321202462371554120593858149755539878561976786592389608;
            6053037282142306509795911286909179687500000000/103899257350518063455290077573775162739725126989;
            917401104920993498360358406096725463867187500/6724249815911346653315790737453607382989551463;
            2585449557665268951371699596493957/84574345160764140163208606048427531;
            0] ;

        b_hat_vector = [552562031208180939317806684253/27669654257734667858523344041464;
            0;
            0;
            0;
            0;
            0;
            0;
            221223388631423597589898601690000000/100946136798587090054685074667127461;
            101835408791305297984657812561920000000/1149763833200743759976506650241312100139;
            1313720309077630014453239843750000000000000000000/11518201923215510989126466531107437037395719117133;
            4833611232701440504508086151728/19081321241454145230196661524503;
            -2129662374582324648106919795703373645353118273066742230724172731025813964712473647144010599206669825382719359113196238857709025512340589957/1035543739272367080885190546201097218891268728118207332592595987554851882972292670881794178380097716583123063485287435793657425889233080568;
            1084761591753640855844358063964843750000000/3182895486031249071938549691320502488733423;
            0;
            0;
            1839190071060649887127895100784/38045139523510634351420875415397] ;

        p_order = 9;
        isFSAL = false;

    case"IIa+9(8)16"
        c_vector = [0 1/25 48/335-32/1675*6^(1/2) 72/335-48/1675*6^(1/2) 72/125 48/125-8/125*6^(1/2) 48/125+8/125*6^(1/2) 16/25 12/25 3377/50000 1/4 57617028499878/85094827871699 1623/2000 453/500 1 1] .';
        
        A_matrix = zeros(16, 16);

        A_matrix(2,1) = 1/25;

        A_matrix(3,1) = -15792/112225 + 5536/112225*6^(1/2);
        A_matrix(3,2) = 31872/112225 - 1536/22445*6^(1/2);

        A_matrix(4,1) = 18/335 - 12/1675*6^(1/2);
        A_matrix(4,2) = 0;
        A_matrix(4,3) = 54/335 - 36/1675*6^(1/2);

        A_matrix(5,1) = 4014/3125 + 252/625*6^(1/2);
        A_matrix(5,2) = 0;
        A_matrix(5,3) = -14742/3125 - 972/625*6^(1/2);
        A_matrix(5,4) = 12528/3125 + 144/125*6^(1/2);

        A_matrix(6,1) = 1232/16875 - 152/16875*6^(1/2);
        A_matrix(6,2) = 0;
        A_matrix(6,3) = 0;
        A_matrix(6,4) = 29684/106875 - 13372/320625*6^(1/2);
        A_matrix(6,5) = -284/21375*6^(1/2) + 2132/64125;

        A_matrix(7,1) = 2032/16875 + 152/16875*6^(1/2);
        A_matrix(7,2) = 0;
        A_matrix(7,3) = 0;
        A_matrix(7,4) = -33652/294975*6^(1/2) - 7348/98325;
        A_matrix(7,5) = -716/21375*6^(1/2) + 10132/64125;
        A_matrix(7,6) = 2592/14375 + 2912/14375*6^(1/2);

        A_matrix(8,1) = 16/225;
        A_matrix(8,2) = 0;
        A_matrix(8,3) = 0;
        A_matrix(8,4) = 0;
        A_matrix(8,5) = 0;
        A_matrix(8,6) = 4/225*6^(1/2) + 64/225;
        A_matrix(8,7) = -4/225*6^(1/2) + 64/225;

        A_matrix(9,1) = 57/800;
        A_matrix(9,2) = 0;
        A_matrix(9,3) = 0;
        A_matrix(9,4) = 0;
        A_matrix(9,5) = 0;
        A_matrix(9,6) = 177/800 + 69/1600*6^(1/2);
        A_matrix(9,7) = 177/800 - 69/1600*6^(1/2);
        A_matrix(9,8) = -27/800;

        A_matrix(10,1) = 2844530829046074022657/58982400000000000000000;
        A_matrix(10,2) = 0;
        A_matrix(10,3) = 0;
        A_matrix(10,4) = 0;
        A_matrix(10,5) = 0;
        A_matrix(10,6) = -1598864762333658025459/117964800000000000000000*6^(1/2) + 4287156859652598464203/58982400000000000000000;
        A_matrix(10,7) = 1598864762333658025459/117964800000000000000000*6^(1/2) + 4287156859652598464203/58982400000000000000000;
        A_matrix(10,8) = -141033886218604337343/6553600000000000000000;
        A_matrix(10,9) = -21409264848554971927/204800000000000000000;

        A_matrix(11, 1) = -72189389771/9959178240000-459663572789/59755069440000*6^(1/2);
        A_matrix(11, 2) = 0;
        A_matrix(11, 3) = 0;
        A_matrix(11, 4) = 0;
        A_matrix(11, 5) = 0;
        A_matrix(11, 6) = 1/30;
        A_matrix(11, 7) = -14201240926266911/557169364500480000-31790792357660029/557169364500480000*6^(1/2);
        A_matrix(11, 8) = 459663572789/56275107840000*6^(1/2)+22414436941/1563197440000;
        A_matrix(11, 9) = 459663572789/11403694080000*6^(1/2)+154180604903/2534154240000;
        A_matrix(11, 10) = 18386542911560000000/1129832575916216250771*6^(1/2)+21871487332435000000/125536952879579583419;

        A_matrix(12,1) = -178144571353393080183496267158614821877982611914666395752937745405391408707734804982447062502773/1247718010112994054746145516410425353598134947600568397156373491324203879120405304413829778240000+352591194575569317115651180991223097026568880384478484650944931412648046608828531034562538513357/8110167065734461355849945856667764798387877159403694581516427693607325214282634478689893558560000*sqrt(6);
        A_matrix(12,2) = 0;
        A_matrix(12,3) = 0;
        A_matrix(12,4) = 0;
        A_matrix(12,5) = 0;
        A_matrix(12,6) = -39115022545645779688585831988975140882502245161831122703201435591036520210945751850583137867/38425428798268102367071108589483043166777031255688218331140907046999467997785653437677908480-490826700396287454540598331961129757400186839154291202145347161815801053957874498846640625/15370171519307240946828443435793217266710812502275287332456362818799787199114261375071163392*sqrt(6);
        A_matrix(12,7) = 643210041535328932923955834959360270277930780334485030265105750796567439186095378077346484617022694073/1814903407134118101527330524719997209072721513421672786517822272756721738310655354625038802858212480000*sqrt(6)-622064296680932516193525865473060264652463486635595667447855699920023546211607797417635623004817316459/907451703567059050763665262359998604536360756710836393258911136378360869155327677312519401429106240000;
        A_matrix(12,8) = 1203943546728385294644268186854769106596033156989737459970836017592684437096940490927391123081521/6546732431504927940789740125933173479539636700187880198168132038132534360122730704444373657280000-151110511960958278763850506139095613011386663021919350564690684891134877118069370443383945077153/3273366215752463970394870062966586739769818350093940099084066019066267180061365352222186828640000*sqrt(6);
        A_matrix(12,9) = 63681466156701378449525903160928961790100434377497936201427140303316098275608362465676059840449/119057634931893490852780569777780769114850167606078444507680127107913165342297705956314829715000-352591194575569317115651180991223097026568880384478484650944931412648046608828531034562538513357/1547749254114615381086147407111149998493052178879019778599841652402871149449870177432092786295000*sqrt(6);
        A_matrix(12,10) = -24757946279683404392669266925829425235785590869511266396518921812563538267024485653444025561440747520000000/269185895336262450059330100908971764013929908518190138634918622045026360125733660563690494055892465375982561*sqrt(6)+1027893404876323970566863593065627643827980253781207669195240625566060297608283559817962257983678464000000/2070660733355865000456385391607475107799460834755308758730143246500202770197951235105311492737634349046197;
        A_matrix(12,11) = 19635000096509466380843956455829094932847113883632439882926745444809822658280742880787456/15009933124323477487137151792766813737022277834253210285601916815234167186635020874092933;
        
        A_matrix(13,1) = -25488511950948766602163761842966272037005387677568247/25343364340644945281003771622773961523200000000000000 + 2525608241949563386308964624438617443527/12416017897756354830807859200000000000000*sqrt(6);
        A_matrix(13,2) = 0;
        A_matrix(13,3) = 0;
        A_matrix(13,4) = 0;
        A_matrix(13,5) = 0;
        A_matrix(13,6) = -2617546081675469247418718340204655213/431392587109884206933606400000000000 - 552470350996365859393640759989/2400793528263703412500070400000*sqrt(6);
        A_matrix(13,7) = -45969294618407232267578352626581642155421231201/10187731154133781589406192186163200000000000000 + 1540493536582818303738906021531546510663696889/885889665576850572991842798796800000000000000*sqrt(6);
        A_matrix(13,8) = 203013873418014401588800777489550153682185921397719/6003783517480134311881093736968119910400000000000000 - 3968812951635028178485515838403541696971/18374628007211630439078297600000000000000*sqrt(6);
        A_matrix(13,9) = 57340072791914637839492204156400815228449519011392389/19744238839693126186283635091213610188800000000000000 - 677602211254760908521917338264019314117/635714271434389910412902400000000000000*sqrt(6);
        A_matrix(13,10) = 24100788715039192225758197856261740786803059875758180717/9662717001210818114953908042643919942065136939286292000 - 8800028717594297513271653743688562521/20449362746897197076153911415852248500*sqrt(6);
        A_matrix(13,11) = 124358916033523439225154730110040589545064737/19935912449945669485002510178704400000000000;
        A_matrix(13,12) = 594716139297486674475082356103592029886330739685357945223223985387172161751824241784555387316314439/818019847119678359631725769101238313386585208743795596694052943582031156000597320370585600000000000;

        A_matrix(14,1) = 184592679361470753674594239208189459317466722387929369596771/127891217091830656233364014205731655064571321600000000000000 - 293880952873230803935166416296767553377/866938749696854853908947200000000000000*sqrt(6);
        A_matrix(14,2) = 0;
        A_matrix(14,3) = 0;
        A_matrix(14,4) = 0;
        A_matrix(14,5) = 0;
        A_matrix(14,6) = 5966995986367380181027852718263477/684582962942931480729600000000000 + 2897291244884828193281565089/19049265055803310768128000000*sqrt(6);
        A_matrix(14,7) = 99009240614446727611594225452277068906413179/16167053833464253010532287404800000000000000 - 3748619435624523040662096435375495632409181/1405830768127326348741938035200000000000000*sqrt(6);
        A_matrix(14,8) = 4632645823113234486269357844283603936661991916850927460433/5096189922215990577140952099757378096638035200000000000000 + 41982993267604400562166630899538221911/116635822311401951029305600000000000000*sqrt(6);
        A_matrix(14,9) = -12135475677184688070559819501757154968443992507349800863475059/3337534088557268857775113382843672473526974754800000000000000 + 293880952873230803935166416296767553377/165447122399672764770545400000000000000*sqrt(6);
        A_matrix(14,10) = -8031428603597180964147750321204281053557209400385686643427859804352/2513586440178391306900178164909088113749933981949109368563389778875 + 21495292553013453087829315020563569618432/29973653446264566614372595657785433238875*sqrt(6);
        A_matrix(14,11) = -44866632128961269158599595825347949153517725172080973/5429607175821308141232283339099249860726338769531250;
        A_matrix(14,12) = -359988533934752543813368225945058137961504440675167771570563740579175484411998973149563531328527853237660249760109643/234128137445668240736067711662442379892483470931740696615716602345729933343308008758732590194294958617150200000000000;
        A_matrix(14,13) = 1011136807359189181222571916914688/2927578889427871359661497484969729;

        A_matrix(15,1) = -43117938494612449223384237106139955697243762787772847383/14030104862294690648579566521727488445420965260989440000 + 4220334940168717525563719481764309232553/5553268895030690235789996003491120640000*sqrt(6);
        A_matrix(15,2) = 0;
        A_matrix(15,3) = 0;
        A_matrix(15,4) = 0;
        A_matrix(15,5) = 0;
        A_matrix(15,6) = -492170504431044248358505817476691843/26311016381549020957251979880325120 - 65372649360291914372644744384375/457582893592156886213077910962176*sqrt(6);
        A_matrix(15,7) = -60242025722206083647640080390153021797730167/4671870346091448695506240355969515576320000 + 312292306982904450161582808948983992497619279/54031196176535884913246084116864832317440000*sqrt(6);
        A_matrix(15,8) = -10128486019754425336362855829794634260766582925227304979/2051440458733049774272501566471676463052668060718080000 - 4220334940168717525563719481764309232553/5229862652007483519857107084128791040000*sqrt(6);
        A_matrix(15,9) = 90164396775224825317874747969895939573106537263617688583/9932194582195572820411492715910530662743409752296080000 - 4220334940168717525563719481764309232553/1059789239915401287502749181781142480000*sqrt(6);
        A_matrix(15,10) = 822220421784353922416106346105112190310210366765138782108892460117760000000/112539961436930436130682455392076582934435837857314380718907401253008522853 - 43216229787327667461772487493266526541342720000000/26879922067906624005297106621487120800647611685231*sqrt(6);
        A_matrix(15,11) = 209814213871916216679569640811090009729840605120/11651974660960738096987230622554824075229159217;
        A_matrix(15,12) = 3941550892863952281184122715485813150214519858148244578543766661999079625453432169420046111603168071904019820197053706993310801913/576348806945747835561749398160966945390916610765210182493857593996732757363976976471505530337022074730630638475548489174498085584;
        A_matrix(15,13) = -4759443892077050695292772766912275498897121280000000000/4614026158486489304426198097242323507384603506591241137;
        A_matrix(15,14) = 38733614144315448443538220691259283298308750000000/93806291160324220065540465392781147766752569954001;

        A_matrix(16,1) = 18092408213832965447840389945226814727838921316097789/4568260908663202892681034746459555501706277524480000 - 156317653995567850184921063401246768027/212359240683067701291661898043594240000*sqrt(6);
        A_matrix(16,2) = 0;
        A_matrix(16,3) = 0;
        A_matrix(16,4) = 0;
        A_matrix(16,5) = 0;
        A_matrix(16,6) = 65946837846509057750066287355594411/3018431611722608724311451319541760 + 41984484090942118562371132909375/52494462812567108248894805557248*sqrt(6);
        A_matrix(16,7) = 8692965898134239206513518248119006769975359/535962614823230784958890847664050959360000 - 38800907634871851557429961190168666395776983/6198524154042582121698476759940763269120000*sqrt(6);
        A_matrix(16,8) = 2641630262222426284468500071736583566105608571199325883/235343729805469979809271071241826755571130067491840000 + 156317653995567850184921063401246768027/199992055607259790546219146109360640000*sqrt(6);
        A_matrix(16,9) = -193422103474923353694542105476136625982637168991506421/16048357343710211432072833749116213173856151273040000 + 156317653995567850184921063401246768027/40526767661819895652001992553977680000*sqrt(6);
        A_matrix(16,10) = -19419587503350096681694941672242361995243037384025897671049255680000000/2155738929233095407456284002740551925607350553898010429805538450410571 + 1600692776914614785893591689228766904596480000000/1027899053306897212338272667278244239283200723671*sqrt(6);
        A_matrix(16,11) = -27285760059113968837908932750404506400064658240/1336728621411169422812695849204871581103756891;
        A_matrix(16,12) = -194853016061874333335484555436551917329750324944158872786342511110263341294405932910123138589192221578993200454377/15840605894584140753571150900860666508000461134947537749588341642048479030548925808450142813874420689113167632464;
        A_matrix(16,13) = 89488735256675489275877211680603518179732480000000000/58814073298029244653337926984054935524805348324518339;
        A_matrix(16,14) = 0;
        A_matrix(16,15) = 0;

        b_vector = [100976787617015984669475787/6921502952403262310437464576 0 0 0 0 0 0 8877148253451235588984375/4385514038208782482187638272 961916572949681511747758515625/4416417715504587515036809762176 1967337516701564001434375000000000000000000000000/15431364863119854943071851131903908575429289017877 2323713252076974806855457536/10352378514220126928031114081 28308600293241456954311939117138937391141264054325158121088859798090056999504636993802634122671806566061266984631226363619/158391546540670080968065757007173890885877631132509858232987982213169380898029758612356596464561682203552186100842929847264 296136352341197653422080000000000000/3899432561650270968394778037550931439 117048651891177050452812500000000/903958175807874008864483503817601 145778296653275182685983/4945417885871057962703934 0];

        b_hat_vector = [34542436255316150799031/1697695107285568386175488 0 0 0 0 0 0 11089416604965799654140625/10367645480399012960254464 19661377435148646805703125/255979697183364488207083392 688790393936688343750000000000000000000000/6091295374506475008386869675533556427693991 2387113868151976968347648/9351742108599933990994683 -12428699133337309103655890990808226652772000718643045082918121983471100560973332724469319414156511978021429/12648919237095643063555422745116719205173888728920704277722434371356124846214898200346632677347950735102176 185286960316915979617280000000000000/465364379785423284294027008596613217 0 0 16723862451391031122709/339047561915509883967882];

        p_order = 9;
        isFSAL = false;
end

stats.n_feval = 0;
stats.n_success_steps = 0;
stats.n_failed_steps = 0;

c = c_vector(:);
A = A_matrix;
b = b_vector(:);
b_hat = b_hat_vector(:);
d = b_hat - b;
z_0 = incond(:);
dzdt = odefun;

s_stages = numel(c);
m = numel(z_0);

t = tspan(1);

zsol = zeros(m, 1); 
K = zeros(m, s_stages);

alpha_safe = 0.7/p_order;
beta_safe = 0.4/p_order;

n = 1;
zsol(:, n) = z_0;
tau(n) = options.MinStepSize;
err(n) = 1;
K(:, 1) = dzdt(t(n), zsol(:, n)); 
stats.n_feval = stats.n_feval + 1;
dzdt_eval(n, :) = K(:, 1);
done = false;

while ~done        
    if t(n) + tau(n) > tspan(2)
        tau(n) = tspan(2) - t(n);
        if tau(n) < eps
            done = true; 
            break; 
        end
    end

    for i = 2:s_stages
        K(:, i) = dzdt( ...
            t(n) + tau(n) * c(i), ...
            zsol(:, n) + tau(n) * K(:, 1:i-1) * A(i, 1:i-1).' ...
        );
        stats.n_feval = stats.n_feval + 1;
    end
    
    zsol(:, n+1) = zsol(:, n) + tau(n) * K * b;
    LTE = tau(n) * K * d;
    err(n+1) = norm(LTE ./ (options.ATol + options.RTol * max(abs(zsol(:, n)), abs(zsol(:, n+1)))), "inf");

    if err(n+1) <= 1
        stats.n_success_steps = stats.n_success_steps + 1;

        if n == 1
            err(n) = err(n+1);
        end

        t(n+1) = t(n) + tau(n);

        factor = options.SafetyFactor * (1 / err(n+1))^alpha_safe;
        % factor = options.SafetyFactor * (1 / error_ratio(n+1))^alpha_safe * (error_ratio(n)/error_ratio(n+1))^beta_safe ;
        factor = min(options.MaxGrowth, max(factor, options.MinGrowth));
        tau(n+1) = min(options.MaxStepSize, max(factor * tau(n), options.MinStepSize));
        n = n + 1;
        if isFSAL
            K(:, 1) = K(:, end);
            dzdt_eval(n, :) = K(:, 1) .';
        else
            K(:, 1) = dzdt(t(n), zsol(:, n));
            dzdt_eval(n, :) = K(:, 1) .';
            stats.n_feval = stats.n_feval + 1;
        end
    else
        stats.n_failed_steps = stats.n_failed_steps + 1;
        factor = options.SafetyFactor * (1 / err(n+1))^alpha_safe;
        factor = min(1, max(factor, options.MinGrowth));

        if factor * tau(n) < options.MinStepSize
            warning('ODE:Underflow', 'Step size underflow at t=%e. Required: %e, Min: %e', t(n), new_tau, options.MinStepSize);
            done = true;
        else
            tau(n) = min(options.MaxStepSize, factor * tau(n));
        end
    end 
end

zsol = zsol .';

t = t(:);
stats.tau_history = tau(:);
stats.error_history = err(:);

end