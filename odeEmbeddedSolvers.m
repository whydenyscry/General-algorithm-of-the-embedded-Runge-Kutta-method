function [t, zsol, dzdt_eval, stats] = odeEmbeddedSolvers(odefun, tspan, incond, options)
% odeEmbeddedSolvers Solve non-stiff ODEs using high-order adaptive Runge-Kutta methods.
%   [t, z] = odeEmbeddedSolvers(odefun, tspan, z0) integrates the system
%   of differential equations z' = f(t,z) from time tspan(1) to tspan(2)
%   with initial conditions z0. odefun is a function handle. For a scalar t
%   and a column vector z, odefun(t,z) must return a column vector of
%   derivatives f(t,z).
%
%   [t, z, dzdt] = odeEmbeddedSolvers(...) also returns the history of
%   derivatives dzdt at each time step.
%
%   [..., stats] = odeEmbeddedSolvers(...) returns a structure stats with
%   computational cost statistics (number of steps, failed steps, etc.).
%
%   [...] = odeEmbeddedSolvers(..., name, value) specifies optional
%   name-value pair arguments:
%
%     'Method'       - Integration method. Specifies the explicit Runge-Kutta pair.
%                      Options:
%                        Order 5:
%                          "Tsit5(4)7*" - Tsitouras 5(4). Modern improvement over
%                                         Dormand-Prince (higher efficiency).
%                          "RK5(4)7*M"  - Dormand-Prince 5(4). Classic standard.
%
%                        Order 6 (Verner IIIXb):
%                          "IIIXb+6(5)9*" (Default) - Robust variant.
%                          "IIIXb-6(5)9*"           - Efficient variant.
%
%                        Order 7 (Verner IIa1):
%                          "IIa1+7(6)10" - Robust.
%                          "IIa1-7(6)10", "IIa1-7(6)10M" - Efficient.
%
%                        Order 8 (Verner IIa):
%                          "IIa+8(7)13" - Robust variant.
%                          "IIa-8(7)13", "IIa-8(7)13M" - Efficient variant.
%
%                        Order 9 (Verner IIa):
%                          "IIa+9(8)16" - Robust variant.
%                          "IIa-9(8)16", "IIa-9(8)16M" - Efficient variant.
%
%                      Legend: "*" denotes FSAL property (saves 1 eval/step).
%                              "+" denotes Robust, "-" denotes Efficient.
%
%     'ATol'         - Absolute tolerance (scalar). Default: 1e-10.
%     'RTol'         - Relative tolerance (scalar). Default: 1e-10.
%
%     'SafetyFactor' - Safety factor for step size prediction. Default: 0.8.
%                      (Lower values like 0.8 increase stability on stiff problems).
%
%     'MinStepSize'  - Minimum allowed step size. Default: 1e-16.
%     'MaxStepSize'  - Maximum allowed step size. Default: 1.0.
% 
% References
% Dormand, J. R., & Prince, P. J. (1980). A family of embedded Runge-Kutta formulae. Journal of Computational and Applied Mathematics, 6(1), 19–26. https://doi.org/10.1016/0771-050x(80)90013-3
% Tsitouras, C. (2011). Runge–Kutta pairs of order 5(4) satisfying only the first column simplifying assumption. Computers & Mathematics With Applications, 62(2), 770–775. https://doi.org/10.1016/j.camwa.2011.06.002
% Verner, J. H. (1978). Explicit Runge–Kutta Methods with Estimates of the Local Truncation Error. SIAM Journal on Numerical Analysis, 15(4), 772–790. https://doi.org/10.1137/0715051
% Verner, J. H. (1993). Differentiable interpolants for High-Order Runge–Kutta Methods. SIAM Journal on Numerical Analysis, 30(5), 1446–1466. https://doi.org/10.1137/0730075
% Verner, J. H. (2009). Numerically optimal Runge–Kutta pairs with interpolants. Numerical Algorithms, 53(2–3), 383–396. https://doi.org/10.1007/s11075-009-9290-3
% Verner, J. H. (n.d.). Jim Verner's Refuge for Runge–Kutta Pairs. Simon Fraser University. https://www.sfu.ca/~jverner/

arguments
    odefun function_handle
    tspan (1,2) double
    incond 
    options.Method (1,1) string {mustBeMember(options.Method, ["Tsit5(4)7*" "RK5(4)7*M" "IIIXb-6(5)9*" "IIIXb+6(5)9*" "IIa1-7(6)10" "IIa1-7(6)10M" "IIa1+7(6)10" "IIa-8(7)13" "IIa-8(7)13M" "IIa+8(7)13" "IIa-9(8)16" "IIa-9(8)16M" "IIa+9(8)16"])} = "IIIXb+6(5)9*"
    options.ATol (1,1) double = 1e-10
    options.RTol (1,1) double = 1e-10
    options.MinStepSize (1,1) double = 1e-16
    options.MaxStepSize (1,1) double = 1
    options.SafetyFactor (1,1) double = 0.8 
    options.MaxGrowth (1,1) double = 5.0   
    options.MinGrowth (1,1) double = 0.2    
end

switch options.Method
    case "Tsit5(4)7*"
        c(1) = 0;
        c(2) = 0.161;
        c(3) = 0.327;
        c(4) = 0.9;
        c(5) = 0.9800255409045096857298102862870245954942137979563024768854764293221195950761080302604;
        c(6) = 1;
        c(7) = 1;
     
        A = zeros(7,7);
        
        A(2,1) = 0.161;
        
        A(3,1) = -0.008480655492356988544426874250230774675121177393430391537369234245294192976164141156943;
        A(3,2) = 0.3354806554923569885444268742502307746751211773934303915373692342452941929761641411569;
        
        A(4,1) = 2.897153057105493432130432594192938764924887287701866490314866693455023795137503079289;
        A(4,2) = -6.359448489975074843148159912383825625952700647415626703305928850207288721235210244366;
        A(4,3) = 4.362295432869581411017727318190886861027813359713760212991062156752264926097707165077;
        
        A(5,1) = 5.325864828439256604428877920840511317836476253097040101202360397727981648835607691791;
        A(5,2) = -11.74888356406282787774717033978577296188744178259862899288666928009020615663593781589;
        A(5,3) = 7.495539342889836208304604784564358155658679161518186721010132816213648793440552049753;
        A(5,4) = -0.09249506636175524925650207933207191611349983406029535244034750452930469056411389539635;
        
        A(6,1) = 5.861455442946420028659251486982647890394337666164814434818157239052507339770711679748;
        A(6,2) = -12.92096931784710929170611868178335939541780751955743459166312250439928519268343184452;
        A(6,3) = 8.159367898576158643180400794539253485181918321135053305748355423955009222648673734986;
        A(6,4) = -0.07158497328140099722453054252582973869127213147363544882721139659546372402303777878835;
        A(6,5) = -0.02826905039406838290900305721271224146717633626879770007617876201276764571291579142206;
        
        A(7,1) = 0.09646076681806522951816731316512876333711995238157997181903319145764851595234062815396;
        A(7,2) = 0.01;
        A(7,3) = 0.4798896504144995747752495322905965199130404621990332488332634944254542060153074523509;
        A(7,4) = 1.379008574103741893192274821856872770756462643091360525934940067397245698027561293331;
        A(7,5) = -3.290069515436080679901047585711363850115683290894936158531296799594813811049925401677;
        A(7,6) = 2.324710524099773982415355918398765796109060233222962411944060046314465391054716027841;

        b(1) = 0.09646076681806522951816731316512876333711995238157997181903319145764851595234062815396;
        b(2) = 0.01;
        b(3) = 0.4798896504144995747752495322905965199130404621990332488332634944254542060153074523509;
        b(4) = 1.379008574103741893192274821856872770756462643091360525934940067397245698027561293331;
        b(5) = -3.290069515436080679901047585711363850115683290894936158531296799594813811049925401677;
        b(6) = 2.324710524099773982415355918398765796109060233222962411944060046314465391054716027841;
        b(7) = 0;
        
        b_hat(1) = 0.09468075576583945237382945810437480985952548450114660586326944637766925714617764855396;
        b_hat(2) = 0.0091835655403432530967763639366453137598137462409840952389059395329229552472536069;
        b_hat(3) = 0.4877705284247615707855642599631228241516691959761363774365216240304071651579539683509;
        b_hat(4) = 1.234297566930478985655109673884237654035539930748192848315425833500484878378046293331;
        b_hat(5) = -2.707712349983525454881109975059321670689605166938197378763992255714444407154924201677;
        b_hat(6) = 1.866628418170587035753719399566211498666255505244122593996591602841258328965762127841;
        b_hat(7) = 1/66;
 
        p_order = 5;
        isFSAL = true;

    case "RK5(4)7*M"
        c(1) = 0;
        c(2) = 1/5;
        c(3) = 3/10;
        c(4) = 4/5;
        c(5) = 8/9;
        c(6) = 1;
        c(7) = 1;

        A = zeros(7,7);
        
        A(2,1) = 1/5;
        
        A(3,1) = 3/40;
        A(3,2) = 9/40;
        
        A(4,1) = 44/45;
        A(4,2) = -56/15;
        A(4,3) = 32/9;
        
        A(5,1) = 19372/6561;
        A(5,2) = -25360/2187;
        A(5,3) = 64448/6561;
        A(5,4) = -212/729;
        
        A(6,1) = 9017/3168;
        A(6,2) = -355/33;
        A(6,3) = 46732/5247;
        A(6,4) = 49/176;
        A(6,5) = -5103/18656;

        A(7,1) = 35/384;
        A(7,2) = 0;
        A(7,3) = 500/1113;
        A(7,4) = 125/192;
        A(7,5) = -2187/6784;
        A(7,6) = 11/84;
        
        b(1) = 35/384;
        b(2) = 0;
        b(3) = 500/1113;
        b(4) = 125/192;
        b(5) = -2187/6784;
        b(6) = 11/84;
        b(7) = 0;
        
        b_hat(1) = 5179/57600;
        b_hat(2) = 0;
        b_hat(3) = 7571/16695;
        b_hat(4) = 393/640;
        b_hat(5) = -92097/339200;
        b_hat(6) = 187/2100;
        b_hat(7) = 1/40;
        
        p_order = 5;
        isFSAL = true;

    case "IIIXb-6(5)9*"
        c(1) = 0;
        c(2) = 3/50;
        c(3) = 1439/15000;
        c(4) = 1439/10000;
        c(5) = 4973/10000;
        c(6) = 389/400;
        c(7) = 1999/2000;
        c(8) = 1;
        c(9) = 1;

        A = zeros(9,9);

        A(2,1) = 3/50;

        A(3,1) = 519479/27000000;
        A(3,2) = 2070721/27000000;

        A(4,1) = 1439/40000;
        A(4,2) = 0;
        A(4,3) = 4317/40000;

        A(5,1) = 109225017611/82828840000;
        A(5,2) = 0;
        A(5,3) = -417627820623/82828840000;
        A(5,4) = 43699198143/10353605000;

        A(6,1) = -8036815292643907349452552172369/191934985946683241245914401600;
        A(6,2) = 0;
        A(6,3) = 246134619571490020064824665/1543816496655405117602368;
        A(6,4) = -13880495956885686234074067279/113663489566254201783474344;
        A(6,5) = 755005057777788994734129/136485922925633667082436;

        A(7,1) = -1663299841566102097180506666498880934230261/30558424506156170307020957791311384232000;
        A(7,2) = 0;
        A(7,3) = 130838124195285491799043628811093033/631862949514135618861563657970240;
        A(7,4) = -3287100453856023634160618787153901962873/20724314915376755629135711026851409200;
        A(7,5) = 2771826790140332140865242520369241/396438716042723436917079980147600;
        A(7,6) = -1799166916139193/96743806114007800;

        A(8,1) = -832144750039369683895428386437986853923637763/15222974550069600748763651844667619945204887;
        A(8,2) = 0;
        A(8,3) = 818622075710363565982285196611368750/3936576237903728151856072395343129;
        A(8,4) = -9818985165491658464841194581385463434793741875/61642597962658994069869370923196463581866011;
        A(8,5) = 31796692141848558720425711042548134769375/4530254033500045975557858016006308628092;
        A(8,6) = -14064542118843830075/766928748264306853644;
        A(8,7) = -1424670304836288125/2782839104764768088217;

        A(9,1) = 382735282417/11129397249634;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 5535620703125000/21434089949505429;
        A(9,5) = 13867056347656250/32943296570459319;
        A(9,6) = 626271188750/142160006043;
        A(9,7) = -51160788125000/289890548217;
        A(9,8) = 163193540017/946795234;

        b(1) = 382735282417/11129397249634;
        b(2) = 0;
        b(3) = 0;
        b(4) = 5535620703125000/21434089949505429;
        b(5) = 13867056347656250/32943296570459319;
        b(6) = 626271188750/142160006043;
        b(7) = -51160788125000/289890548217;
        b(8) = 163193540017/946795234;
        b(9) = 0;
        
        b_hat(1) = 273361583/5567482366;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 1964687500000/8727630165387;
        b_hat(5) = 596054687500/1269637976277;
        b_hat(6) = 12740367500/15795556227;
        b_hat(7) = 0;
        b_hat(8) = -4462730789736252634813752317/7350663039626676022821734166;
        b_hat(9) = 441454562788983500/7763730504400359099;

        p_order = 6;
        isFSAL = true;

    case "IIIXb+6(5)9*"
        c(1) = 0;
        c(2) = 9/50;
        c(3) = 1/6;
        c(4) = 1/4;
        c(5) = 53/100;
        c(6) = 3/5;
        c(7) = 4/5;
        c(8) = 1;
        c(9) = 1;
        
        A = zeros(9,9);
        
        A(2,1) = 9/50;
        
        A(3,1) = 29/324; 
        A(3,2) = 25/324;
        
        A(4,1) = 1/16;   
        A(4,3) = 3/16; 
       
        A(5,1) = 79129/250000;
        A(5,3) = -261237/250000;
        A(5,4) = 19663/15625;
        
        A(6,1) = 1336883/4909125;
        A(6,3) = -25476/30875;
        A(6,4) = 194159/185250;
        A(6,5) = 8225/78546;
        
        A(7,1) = -2459386/14727375;
        A(7,3) = 19504/30875;
        A(7,4) = 2377474/13615875;
        A(7,5) = -6157250/5773131;
        A(7,6) = 902/735;
       
        A(8,1) = 2699/7410;
        A(8,3) = -252/1235;
        A(8,4) = -1393253/3993990;
        A(8,5) = 236875/72618;
        A(8,6) = -135/49;
        A(8,7) = 15/22;

        A(9,1) = 11/144;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 256/693;
        A(9,5) = 0;
        A(9,6) = 125/504;
        A(9,7) = 125/528;
        A(9,8) = 5/72;
        A(9,9) = 0;

        b(1) = 11/144;
        b(2) = 0;
        b(3) = 0;
        b(4) = 256/693;
        b(5) = 0;
        b(6) = 125/504;
        b(7) = 125/528;
        b(8) = 5/72;
        b(9) = 0;
        
        b_hat(1) = 28/477;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 212/441;
        b_hat(5) = -312500/366177;
        b_hat(6) = 2125/1764;
        b_hat(7) = 0;
        b_hat(8) = -2105/35532;
        b_hat(9) = 2995/17766;

        p_order = 6;
        isFSAL = true;

    case "IIa1-7(6)10"        
        c(1) = 0;
        c(2) = 1/200;
        c(3) = 49/450;
        c(4) = 49/300;
        c(5) = 911/2000;
        c(6) = 3480084980/5709648941;
        c(7) = 221/250;
        c(8) = 37/40;
        c(9) = 1;
        c(10) = 1;

        A = zeros(10,10);

        A(2,1) = 1/200;

        A(3,1) = -4361/4050;
        A(3,2) = 2401/2025;

        A(4,1) = 49/1200;
        A(4,2) = 0;
        A(4,3) = 49/400;

        A(5,1) = 2454451729/3841600000;
        A(5,2) = 0;
        A(5,3) = -9433712007/3841600000;
        A(5,4) = 4364554539/1920800000;

        A(6,1) = -6187101755456742839167388910402379177523537620/2324599620333464857202963610201679332423082271;
        A(6,2) = 0;
        A(6,3) = 27569888999279458303270493567994248533230000/2551701010245296220859455115479340650299761;
        A(6,4) = -37368161901278864592027018689858091583238040000/4473131870960004275166624817435284159975481033;
        A(6,5) = 1392547243220807196190880383038194667840000000/1697219131380493083996999253929006193143549863;

        A(7,1) = 11272026205260557297236918526339/1857697188743815510261537500000;
        A(7,2) = 0;
        A(7,3) = -48265918242888069/1953194276993750;
        A(7,4) = 26726983360888651136155661781228/1308381343805114800955157615625;
        A(7,5) = -2090453318815827627666994432/1096684189897834170412307919;
        A(7,6) = 1148577938985388929671582486744843844943428041509/1141532118233823914568777901158338927629837500000;

        A(8,1) = 1304457204588839386329181466225966641/108211771565488329642169667802016000;
        A(8,2) = 0;
        A(8,3) = -1990261989751005/40001418792832;
        A(8,4) = 2392691599894847687194643439066780106875/58155654089143548047476915856270826016;
        A(8,5) = -1870932273351008733802814881998561250/419326053051486744762255151208232123;
        A(8,6) = 1043329047173803328972823866240311074041739158858792987034783181/510851127745017966999893975119259285040213723744255237522144000;
        A(8,7) = -311918858557595100410788125/3171569057622789618800376448;

        A(9,1) = 17579784273699839132265404100877911157/1734023495717116205617154737841023480;
        A(9,2) = 0;
        A(9,3) = -18539365951217471064750/434776548575709731377;
        A(9,4) = 447448655912568142291911830292656995992000/12511202807447096607487664209063950964109;
        A(9,5) = -65907597316483030274308429593905808000000/15158061430635748897861852383197382130691;
        A(9,6) = 273847823027445129865693702689010278588244606493753883568739168819449761/136252034448398939768371761610231099586032870552034688235302796640584360;
        A(9,7) = 694664732797172504668206847646718750/1991875650119463976442052358853258111;
        A(9,8) = -19705319055289176355560129234220800/72595753317320295604316217197876507;

        A(10,1) = -511858190895337044664743508805671/11367030248263048398341724647960;
        A(10,2) = 0;
        A(10,3) = 2822037469238841750/15064746656776439;
        A(10,4) = -23523744880286194122061074624512868000/152723005449262599342117017051789699;
        A(10,5) = 10685036369693854448650967542704000000/575558095977344459903303055137999707;
        A(10,6) = -6259648732772142303029374363607629515525848829303541906422993/876479353814142962817551241844706205620792843316435566420120;
        A(10,7) = 17380896627486168667542032602031250/13279937889697320236613879977356033;
        A(10,8) = 0;
        A(10,9) = 0;

        b(1) = 96762636172307789/2051985304794103980;
        b(2) = 0;
        b(3) = 0;
        b(4) = 312188947591288252500000/1212357694274963646019729;
        b(5) = 13550580884964304000000000000/51686919683339547115937980629;
        b(6) = 72367769693133178898676076432831566019684378142853445230956642801/475600216991873963561768100160364792981629064220601844848928537580;
        b(7) = 1619421054120605468750/3278200730370057108183;
        b(8) = -66898316144057728000/227310933007074849597;
        b(9) = 181081444637946577/2226845467039736466;
        b(10) = 0;
        
        b_hat(1) = 117807213929927/2640907728177740;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 4758744518816629500000/17812069906509312711137;
        b_hat(5) = 1730775233574080000000000/7863520414322158392809673;
        b_hat(6) = 2682653613028767167314032381891560552585218935572349997/12258338284789875762081637252125169126464880985167722660;
        b_hat(7) = 40977117022675781250/178949401077111131341;
        b_hat(8) = 0;
        b_hat(9) = 0;
        b_hat(10) = 2152106665253777/106040260335225546;

        p_order = 7;
        isFSAL = false;

    case "IIa1-7(6)10M"
        c(1) = 0;
        c(2) = 69/1000;
        c(3) = 59/500;
        c(4) = 177/1000;
        c(5) = 501/1000;
        c(6) = 2315802800/2992844303;
        c(7) = 497/500;
        c(8) = 499/500;
        c(9) = 1;
        c(10) = 1;

        A = zeros(10,10);

        A(2,1) = 69/1000;

        A(3,1) = 59/3450;
        A(3,2) = 3481/34500;

        A(4,1) = 177/4000;
        A(4,2) = 0;
        A(4,3) = 531/4000;

        A(5,1) = 10238937/13924000;
        A(5,2) = 0;
        A(5,3) = -39407157/13924000;
        A(5,4) = 2259009/870250;

        A(6,1) = -15383063799457947774162786564155688537984607600/1259275502826931493365457235462458740508569749;
        A(6,2) = 0;
        A(6,3) = 13636329640266997061898077655506436320000000/279280439748709579366923316802496948438361;
        A(6,4) = -7849857552131913028846468911879258886700000000/203595440576809283358487097949020275411565169;
        A(6,5) = 26558492028140990975913366297943027060000000/9767434236233022212257209238002409076050383;

        A(7,1) = 1693631672689148171299746335956403/15557685084971650515961800000000;
        A(7,2) = 0;
        A(7,3) = -12886387619105287/29798414847430;
        A(7,4) = 166792207691509721753786653837972/484985800197446538759747217875;
        A(7,5) = -8612993672719804438712813/419115390059666125531071;
        A(7,6) = 8711496371958872516559009756267806714231541783/7119664157324003895788891707124597610200000000;

        A(8,1) = 482598318810345340147549821069890673511/4252885096093048652227854892200000000;
        A(8,2) = 0;
        A(8,3) = -335837225452900919/744960371185750;
        A(8,4) = 4314718692790068364584679604398347481136/12035031825554428462193835378358401375;
        A(8,5) = -19520073049463013534179746511408887/910006917045880487844897509844735;
        A(8,6) = 213273724212084347100323074348539394670238604390859671493442803321/167397801251712736685049467180589771772846483007282174245800000000;
        A(8,7) = -3550009354482848439238/1632793352473881246850155;

        A(9,1) = 464627742666489022675930201058294647073/4015810365668612776899447493147250400;
        A(9,2) = 0;
        A(9,3) = -1244924757503648062100000/2708339114775423710831;
        A(9,4) = 864659299303807467036797204818807058621375000/2365342873784133828255245219573718795686067;
        A(9,5) = -414659562054100142126373639303068923975000/18947103805180679925384667287569757463641;
        A(9,6) = 251512033288886919998655372996651140090744320679272221558349952682043771161/193661758784000518862549108190096025969740958697864544201340884431322887200;
        A(9,7) = -129993524671997661561380436281250/2444084122502261426468505184352693297;
        A(9,8) = -330048664133494745911800776343750/106519032367013306849702395825384439;

        A(10,1) = 470079564369459040686787340931565597/3786249933535897266309463814153100;
        A(10,2) = 0;
        A(10,3) = -1439402335766809850000/2918307634665215021;
        A(10,4) = 1217576093985000201402477212355810625000/3104409301326893443345355830426079157;
        A(10,5) = -964786499051902131132330939617300000/41078490380170414512884911711048923;
        A(10,6) = 105909114887436922177247742512269809363763568654627062084851/77741562653892131345714509407181067729754534520235410312700;
        A(10,7) = -129993524671997661561380436281250/18434960824828884218598340292834789;
        A(10,8) = 0;
        A(10,9) = 0;

        b(1) = 110449732827920922049/2139039437196626445600;
        b(2) = 0;
        b(3) = 0;
        b(4) = 82144253503717584250000000/296852662604261569174926543;
        b(5) = 28701859979839412750000000/85063334157510472676763963;
        b(6) = 2000756020505118480302890049859609915307579431466395123771510448993/10616972547296396564204658747724522321501545545777484342713104600800;
        b(7) = 101994151411635671875000/4156013744827048489581;
        b(8) = -32907155770141921875000/478218947736615415477;
        b(9) = 778034793098369351/17516858519634453;
        b(10) = 0;
        
        b_hat(1) = 31168104595177243/612378882678679200;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 14430837870576125000000/51653499670134255990069;
        b_hat(5) = 8023020477538375000000/24450512836306545753597;
        b_hat(6) = 1013340986447375509449239341420768103367507272384401717/4520370232598781381352724440907944812168778918885975200;
        b_hat(7) = 467526300172843750000/593716249261006927083;
        b_hat(8) = 0;
        b_hat(9) = 0;
        b_hat(10) = -1676706483576682/2502408359947779;

        p_order = 7;
        isFSAL = false;

    case "IIa1+7(6)10"
        c(1) = 0;
        c(2) = 1/200;
        c(3) = 49/450;
        c(4) = 49/300;
        c(5) = 91/200;
        c(6) = 34704460/57271701;
        c(7) = 167/200;
        c(8) = 183/200;
        c(9) = 1;
        c(10) = 1;
        
        A = zeros(10,10);
        
        A(2,1) = 1/200;
        
        A(3,1) = -4361/4050;
        A(3,2) = 2401/2025;
        
        A(4,1) = 49/1200;
        A(4,3) = 49/400;
        
        A(5,1) = 1781/2800;
        A(5,3) = -13689/5600;
        A(5,4) = 507/224;
        
        A(6,1) = -275776923568321554889485313326460/108782544039075797415588764982099;
        A(6,3) = 9576001512158705648097438730000/929765333667314507825544999847;
        A(6,4) = -22178538465642954902290458689600/2789296001001943523476634999541;
        A(6,5) = 12323686750109283453854913779200/15540363434153685345084109283157;
        
        A(7,1) = 8221508014471276464993/8206108584945090400000;
        A(7,3) = -9852144759099/2364568872400;
        A(7,4) = 15322550932778398907299/3996134347464283007200;
        A(7,5) = -18338463121898520004/36506562121215938675;
        A(7,6) = 23340475544602125119307511373519383499/34957329425893779598660175543672800000;
        
        A(8,1) = 81088643022740545033730780169/2975182110231937140152800000;
        A(8,3) = -2837794586103/67559110640;
        A(8,4) = -14167575606881316095038341141/1344719188593468553337836000;
        A(8,5) = 2395552232834276839307772/29760062864388068268875;
        A(8,6) = -4076715891031001341580357765362043260356514682697/60535801523558513633981092635987721507186400000;
        A(8,7) = 36551527355459957808/2801171464968864455;
        
        A(9,1) = -3347747115771808477876752833599/1101327591307901549464211073280;
        A(9,3) = 1214704878477625125/119815105452943264;
        A(9,4) = -65581118617864038124456452415/10200342297342072539428709672;
        A(9,5) = -133373082911575479273298406095/84070826916189821955373830704;
        A(9,6) = 622515683654039386383701463758952267447736841050281950137693/328994218860140584540186142455568117669077094653332432085760;
        A(9,7) = 46169188671551441399013763125/2343692704156841275628930358208;
        A(9,8) = 18880867865877597493091875/3469664148196911643475533504;
        
        A(10,1) = -74309815528722196127526037/51427190037752065777334640;
        A(10,3) = 913722369253875/113761793498234;
        A(10,4) = -440658227159292602060396890/58109996881684093545238767;
        A(10,5) = 37290888293935763341814380/10411746696360295961914239;
        A(10,6) = -645152888113581065780360392105179310452496326847/264735425121804814898131042131367320451487910960;
        A(10,7) = 473757486190086838681892500/556321100802942639360459887;
        
        b(1) = 9420080774669597/198627609019792680;
        b(2) = 0;
        b(3) = 0;
        b(4) = 18658605936510000/72821569629535727;
        b(5) = 296950875175030000/1101802245630054969;
        b(6) = 18875276980274212686824835566143151189850553896330009/148780947139609706104394157596648357994575577036224440;
        b(7) = 18663850606812500/74993696164706319;
        b(8) = 179884749312500/58508928482581269;
        b(9) = 349315176247648/7273791403140339;
        b(10) = 0;
        
        b_hat(1) = 7362904929137/155056681514280;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 7505178129270000/29317774785916981;
        b_hat(5) = 1851744839320000/6843492208882329;
        b_hat(6) = 750882778189818437512810407839645051128089/6004363295715536270735789992319176322209240;
        b_hat(7) = 27902602073000000/110704980052661709;
        b_hat(8) = 0;
        b_hat(9) = 0;
        b_hat(10) = 331667036438/6791588611709;

        p_order = 7;
        isFSAL = false;

    case"IIa-8(7)13"        
        c(1) = 0;
        c(2) = 1/20;
        c(3) = 341/3200;
        c(4) = 1023/6400;
        c(5) = 39/100;
        c(6) = 93/200;
        c(7) = 31/200;
        c(8) = 943/1000;
        c(9) = 7067558016280/7837150160667;
        c(10) = 909/1000;
        c(11) = 47/50;
        c(12) = 1;
        c(13) = 1;

        A = zeros(13,13);

        A(2,1) = 1/20;

        A(3,1) = -7161/1024000;
        A(3,2) = 116281/1024000;

        A(4,1) = 1023/25600;
        A(4,2) = 0;
        A(4,3) = 3069/25600;

        A(5,1) = 4202367/11628100;
        A(5,2) = 0;
        A(5,3) = -3899844/2907025;
        A(5,4) = 3982992/2907025;

        A(6,1) = 5611/114400;
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = 31744/135025;
        A(6,5) = 923521/5106400;

        A(7,1) = 21173/343200;
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = 8602624/76559175;
        A(7,5) = -26782109/689364000;
        A(7,6) = 5611/283500;

        A(8,1) = -1221101821869329/690812928000000;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = -125/2;
        A(8,5) = -1024030607959889/168929280000000;
        A(8,6) = 1501408353528689/265697280000000;
        A(8,7) = 6070139212132283/92502016000000;

        A(9,1) = -1472514264486215803881384708877264246346044433307094207829051978044531801133057155/1246894801620032001157059621643986024803301558393487900440453636168046069686436608;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = -5172294311085668458375175655246981230039025336933699114138315270772319372469280000/124619381004809145897278630571215298365257079410236252921850936749076487132995191;
        A(9,5) = -12070679258469254807978936441733187949484571516120469966534514296406891652614970375/2722031154761657221710478184531100699497284085048389015085076961673446140398628096;
        A(9,6) = 780125155843893641323090552530431036567795592568497182701460674803126770111481625/183110425412731972197889874507158786859226102980861859505241443073629143100805376;
        A(9,7) = 664113122959911642134782135839106469928140328160577035357155340392950009492511875/15178465598586248136333023107295349175279765150089078301139943253016877823170816;
        A(9,8) = 10332848184452015604056836767286656859124007796970668046446015775000000/1312703550036033648073834248740727914537972028638950165249582733679393783;

        A(10,1) = -29055573360337415088538618442231036441314060511/22674759891089577691327962602370597632000000000;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = -20462749524591049105403365239069/454251913499893469596231268750;
        A(10,5) = -180269259803172281163724663224981097/38100922558256871086579832832000000;
        A(10,6) = 21127670214172802870128286992003940810655221489/4679473877997892906145822697976708633673728000;
        A(10,7) = 318607235173649312405151265849660869927653414425413/6714716715558965303132938072935465423910912000000;
        A(10,8) = 212083202434519082281842245535894/20022426044775672563822865371173879;
        A(10,9) = -2698404929400842518721166485087129798562269848229517793703413951226714583/469545674913934315077000442080871141884676035902717550325616728175875000000;

        A(11,1) = -2342659845814086836951207140065609179073838476242943917/1358480961351056777022231400139158760857532162795520000;
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = -996286030132538159613930889652/16353068885996164905464325675;
        A(11,5) = -26053085959256534152588089363841/4377552804565683061011299942400;
        A(11,6) = 20980822345096760292224086794978105312644533925634933539/3775889992007550803878727839115494641972212962174156800;
        A(11,7) = 890722993756379186418929622095833835264322635782294899/13921242001395112657501941955594013822830119803764736;
        A(11,8) = 161021426143124178389075121929246710833125/10997207722131034650667041364346422894371443;
        A(11,9) = 300760669768102517834232497565452434946672266195876496371874262392684852243925359864884962513/4655443337501346455585065336604505603760824779615521285751892810315680492364106674524398280000;
        A(11,10) = -31155237437111730665923206875/392862141594230515010338956291;

        A(12,1) = -2866556991825663971778295329101033887534912787724034363/868226711619262703011213925016143612030669233795338240;
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = -16957088714171468676387054358954754000/143690415119654683326368228101570221;
        A(12,5) = -4583493974484572912949314673356033540575/451957703655250747157313034270335135744;
        A(12,6) = 2346305388553404258656258473446184419154740172519949575/256726716407895402892744978301151486254183185289662464;
        A(12,7) = 1657121559319846802171283690913610698586256573484808662625/13431480411255146477259155104956093505361644432088109056;
        A(12,8) = 345685379554677052215495825476969226377187500/74771167436930077221667203179551347546362089;
        A(12,9) = -3205890962717072542791434312152727534008102774023210240571361570757249056167015230160352087048674542196011/947569549683965814783015124451273604984657747127257615372449205973192657306017239103491074738324033259120;
        A(12,10) = 40279545832706233433100438588458933210937500/8896460842799482846916972126377338947215101;
        A(12,11) = -6122933601070769591613093993993358877250/1050517001510235513198246721302027675953;

        A(13,1) = -618675905535482500672800859344538410358660153899637/203544282118214047100119475340667684874292102389760;
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = -4411194916804718600478400319122931000/40373053902469967450761491269633019;
        A(13,5) = -16734711409449292534539422531728520225/1801243715290088669307203927210237952;
        A(13,6) = 135137519757054679098042184152749677761254751865630525/16029587794486289597771326361911895112703716593983488;
        A(13,7) = 38937568367409876012548551903492196137929710431584875/340956454090191606099548798001469306974758443147264;
        A(13,8) = -6748865855011993037732355335815350667265625/7002880395717424621213565406715087764770357;
        A(13,9) = -1756005520307450928195422767042525091954178296002788308926563193523662404739779789732685671/348767814578469983605688098046186480904607278021030540735333862087061574934154942830062320;
        A(13,10) = 53381024589235611084013897674181629296875/8959357584795694524874969598508592944141;
        A(13,11) = 0;
        A(13,12) = 0;

        b(1) = 44901867737754616851973/1014046409980231013380680;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 791638675191615279648100000/2235604725089973126411512319;
        b(7) = 3847749490868980348119500000/15517045062138271618141237517;
        b(8) = -13734512432397741476562500000/875132892924995907746928783;
        b(9) = 12274765470313196878428812037740635050319234276006986398294443554969616342274215316330684448207141/489345147493715517650385834143510934888829280686609654482896526796523353052166757299452852166040;
        b(10) = -9798363684577739445312500000/308722986341456031822630699;
        b(11) = 282035543183190840068750/12295407629873040425991;
        b(12) = -306814272936976936753/1299331183183744997286;
        b(13) = 0;
        
        b_hat(1) = 10835401739407019406577/244521829356935137978320;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 0;
        b_hat(5) = 0;
        b_hat(6) = 13908189778321895491375000/39221135527894265375640567;
        b_hat(7) = 73487947527027243487625000/296504045773342769773399443;
        b_hat(8) = 68293140641257649609375000/15353208647806945749946119;
        b_hat(9) = 22060647948996678611017711379974578860522018208949721559448560203338437626022142776381/1111542009262325874512959185795727215759010577565736079641376621381577236680929558640;
        b_hat(10) = -547971229495642458203125000/23237214025700991642563601;
        b_hat(11) = 0;
        b_hat(12) = 0;
        b_hat(13) = -28735456870978964189/79783493704265043693;

        p_order = 8;
        isFSAL = false;

    case "IIa-8(7)13M"
        c(1) = 0;
        c(2) = 46331/500000;
        c(3) = 1269480357/9674218750;
        c(4) = 3808441071/19348437500;
        c(5) = 427173/1000000;
        c(6) = 121493/250000;
        c(7) = 32383/200000;
        c(8) = 246367/250000;
        c(9) = 722796614311973983293430480000/750803277226725320982643130363;
        c(10) = 49813/50000;
        c(11) = 997947/1000000;
        c(12) = 1;
        c(13) = 1;

        A = zeros(13,13);
        
        A(2,1) = 46331/500000;
        
        A(3,1) = 5315411330652419433/138756539063652343750;
        A(3,2) = 6446321507235389796/69378269531826171875;
        
        A(4,1) = 3808441071/77393750000;
        A(4,2) = 0;
        A(4,3) = 11425323213/77393750000;
        
        A(5,1) = 75446401566920570003419583/275043050975376631296000000;
        A(5,2) = 0;
        A(5,3) = -3417826948116965658992711/3667240679671688417280000;
        A(5,4) = 5967631695123128322832799/5500861019507532625920000;
        
        A(6,1) = 5191682213889523/80343552186000000;
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = 230690056234369291/858340336110579072;
        A(6,5) = 217873808227934804401/1427832914435795953125;
        
        A(7,1) = 50757818420839505462809777/706033082232465366988800000;
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = 848345405142033534202847085890275/6946443736483448598794023322566656;
        A(7,5) = -5253135630517348498676401/66130823905209396182880000;
        A(7,6) = 1490000139985552391753583/31479515502831516797440000;
        
        A(8,1) = -90852628181665238168819103632964427529/14958602795234983508968403292187500000;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = -184739/2500;
        A(8,5) = 8850547632993458784035285532690369049/741260977748803109695477326679687500;
        A(8,6) = -15821150645305891763449884455101934621/4120894521934817069817733137187500000;
        A(8,7) = 112813146316622442220935800749156859101/1548481049000436659046564851367187500;
        
        A(9,1) = -536503832638008303263367863576800278602673892370439721899131857210426417705672428417351936947831803399614197960175320040769293381785481318247707817164515202703687899232065840654469533060981932721120080000/110195829615022223157322032059088708934367043813083819511275779163860582939330771488931320144929927289660605298210804281320149851385693821821309936435244063163316006382638069933986591673830630854537426877;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = -3261181329115349893104321060800455252053535236667388680937516257026499554227703364423723701129562987894657394803229097876951612489846129160433527126101421068608935202363396824618534460937500000000000/55100806213429851405763396003570550302958708079460578872559792171749561229485042024791601405570417662599292493175534680868010815876118213670612945143198130984996932304039921791379362010146120527417;
        A(9,5) = 37751184425691091870114906188485223655986258885914822499271491183779022330524252214351273536402325420076631500613386460051317490145776357440002807010066367780840666226437084932621469036558432336000000000000/4089689454438399113433644686636966252715906086603215069574691931461561182692052614217903813115455099009538988902043548643926665902556887850349516813026243891978309601041649725522271506706881628765729820537;
        A(9,6) = -265264913511053276648322309842912286876922213043759576087477881594370623201547743675092153089753453724061799483479898862294430736293588302272135073273975458589512879863467951191232776876099838000000000000/99095997209377067561990166610146255622234158075166616880983764551120656108319804381137875310958334345479771705716603177395663420846013915656067352940214553052076985065440757555988443027474051555871410801;
        A(9,7) = 155638942417613871459597896010256270765552458602391308067510781623455358943227232629335108578903890826632290731072383558879725974442976093780815663573598762441657097458356048298043132800000000000/2662442644387878580778780441949114822835851794377267696102733153190684718405150957027853789007945731669893001526506391060107796872709492020373945639877186501109777103675058962752374089485608711;
        A(9,8) = 17814755542047520337043674814520543700515694475881084016835000089455362480986973099639476618370684603980772537087396537202580167392037773056164955802500000000000000/3022365022716366530583229444263367654293831965926609477373919716082875865356791992498860632155441370007239789035911345927686575730670250353600367551431475897664543241;
        
        A(10,1) = -91020424740587198798872704719214240983293072694145219485750386446869711317629085468941654466449562224600415737786121196551/13605725515772976072640181458642034609088064116914514778428827794495507695401619719085709782820140196877119350000000000000;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = -8262794618170578336122632314443915441979288063341639852712796421298940947635729/101455300468985893297419386727253427234194528695661866691059839827876670296704;
        A(10,5) = 1890442086133853233920651726585706939784202225482847345647403239370299603083463016687419/141417716213914145032895592454881538291781199389806701134996909781576790647176353781250;
        A(10,6) = -637211009344798631164698036263857733504513301435728876940525804188523584348221776323963556427257563792978041078814959857/142528003153057097305731371637459144459439616287773295833208845422083341624769920764213996531287440672762830210835250000;
        A(10,7) = 1118192935926620948220205123393666048584345528320963779732446532560671432899819267807962343107905553530843358187/13936783549753699439785396148652551638798806265268118666179508301363250337739493511661123351975779126742343750;
        A(10,8) = -46378575357061931962286024323589432361747222713653389251485523127908204671500/3530543687602214520615012627557325139778432647352038513865653816884701735664011;
        A(10,9) = 589211855620022836894945953211852076783495241802162260776636007033552436835294229967010197367786945232088781868190646008758612299130399072864243356729241443901835581277/50172236152930524250080042471954355137124055046385118660538994999975741500295096424379356315730088791906232911424844422555029381805590173452460606966889862450000000000000;
        
        A(11,1) = -14413513898078986166618213989166779919318077464055075837588338341282227270053101545655479642912917173242949947053595644243000294270631538040321103/2123118197760358126930787825378857987460398806592035433005179119790762867096626557833430359461079262891523442356001713588630096008000000000000000;
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = -56651614321399372089524439260167400212273679809424709929775629144475418887897233873/685386918723815812498122079224112041759891927188471277201826473503877950448844800;
        A(11,5) = 168903567349621314153412993786858224297176845256554638284016610429284297217312605770643422639/12419618099497526692666741808482040873980428888633690730789061943484255036392021114300000000;
        A(11,6) = -365519540137842805889230196611146912970488900271104850121674766190534749233663295517335941859463904664742612123299741824200717524762157540223058244677/79904341954619650880884674794018460010120707890789475816048439539071661280173335294325175005481399748338621842593838030851707102420074828014400000000;
        A(11,7) = 5334042887709893375015448607146230287073128107672818427480797639015260405995616179645324973128770048657963790733808932605807393632803074619/65513142894222293777918583682762138094704420718806790433266647474717316338057396655913759888005192583800978812424113440735457772062500000;
        A(11,8) = -8367540232797896141298545581870568403061643591608191210030808400183122903611225737948197163700038217/590824498618870863414998179520774472845232460708213946792463839024528387246576160889056336184157281984;
        A(11,9) = 38521213439839165365475518567811026797857136608502209244475976919345476690935850191763772499488465392634652338228555830742194677675554797866184565537779774769720984216686337340481570198416710320003362314652020950047791171/2800643369851260742344921015442997052910128780895887549662680802491793278654196975992418333442236240619678753515466150792906078734948799270090282185609483669898184079647607915524942624965845102998777402481256000000000000000;
        A(11,10) = -82191463923196462936568620587278710424874580196633175245262587807879/73936054593071362885694507846341060352306444765632038321118113707376000;
        
        A(12,1) = -36748410018782723273414418648367613308045200590140839640976574345513202573813806861572473532505839882030674380287110316693893036266592210841170337/5318002954421623422197801345310402046532405449919012621535310956418637766921167828021986531872051772982142140544931927754106915056042511683040000;
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = -84069200511175110774748675088566395111477203940732076301583397081677995944453283443280790551757812500/999099755490918844973565860998201356153956059690100122211738512194206475888396075139266574715346003;
        A(12,5) = 1029653041512007463325641938335381074559733140944879085811283494722013252304374388831663255151849174550000000/74155135192328663123806951422681921463625549619488217397785323928939842826573328302261357516804171725464083;
        A(12,6) = -1481467568628288018166346940788546296873789288072878115841967815654046647614040631815876082980563875099427792372477497519777959560465683254873790625000/315041053068505211497046048261619139876812239622575646669794065234738664985654797175719777009915742386996464501241055749119010690472973509780313019379;
        A(12,7) = 38839688990987172731995611136285998930719167449995067433659510479350571265591992259355191879796221799516952738989769336133467815377790000000/468658871568639762165161804836346435119778547511562541815252622670953523948354122334688113850958064874257766137285696412883026714589256119;
        A(12,8) = -64881555310829063196801952671358698715642025168737709471937885825920239990418469037298184775466535156250000/3942973009701146622550110898356568785545034511327052049864437772202183523751563517089269651506076864610353429;
        A(12,9) = 52571123618990723025426187478677022854960356314183947655459861680696282192880138325921511800724249400986154157266595405852397259596193621082131537868054265997512969647635415716985832667488636037975516784444749154807954809123939624390540023449125157433/3196465935218758652958261771461363546348511227098201762245786036520292335669564091817658435446854409195719119364656161130691754789131893011166106311670530001573312476772881528116135550022670694810770858881705536478812442432416143806440397006035995360000;
        A(12,10) = 4686303432085488423230426123697613186662362780209259175044652983397669559967217993482218348547890625000/1096096111930431746793234795723873502158970651960477263965869341427186968279933713964445359453984837750723;
        A(12,11) = -1266015665421501050315664047913219829720270763906664400955352450916592950985896667973810357406750000000000/214481919143450379627866542344871877687501604117026044442100118195087562099376655562899524146991565436551353;
        
        A(13,1) = -49124763234653321076619614962965518664399514042149042567673832358788577877392593576140868183994581163185913481221305967180405891422367559/7107197422141305799496740266631631344343305998178230802321640321817501748769308687275440403172639578259341306381342099980870903765280000;
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = -4153755172003575431401636115166730834379237679652299091515254770137065640332920967289721679687500/49351728783855965400449870225463458653974058205850990256287994510618285451949168184004913354981;
        A(13,5) = 50872758238538960952180550457736980958733683809441246276060362440551414735144789555394797485777850000000/3662981699103459603781235967488990560856215555308709498701213076404225880479076816766413332660526287141;
        A(13,6) = -3574124452883768035400196194143843387406232072663744849413713784487131759608291059522377771236678456119017115907182637174952380506509903125000/759892087449533827250922578006291300099121237554243303576456102073725018441332462056945731727898593777113757676476742624352984876270492100027;
        A(13,7) = 3966436529885543813043261367926217751325070008869592742012847352891550065789949089223191991259007056105376309480834797271464570000000/47848816205799495410548088255404622373309921593704650728388680088289245315277210251458931233663196625289859954118116917537345341677;
        A(13,8) = -477755658693899506090458125866452676223445394319797191385689694557325435499949949617820652343750000/46822952148082164078327484045696371544927643699532080777416324799624778219594453434351725594445725031;
        A(13,9) = 1352211870656006858197756905880134251938199475035000499745027362824892758909587891411580767144395353722304997582115835170503067975431442561398169046564681996123998455348542723721374161683918357788481993740742937/94699311566618096082331038430382358918437857748866186406151762108158258282292908568173638369400256946414672242640214546404746810960212396035818495237645143310143632148131882550218627319714272844523455327075040000;
        A(13,10) = -26661111973311244336423031296156079630518844922155732233357233546713458947237973079693828125000/4584891181085754625880987012573856486681459760918410831605662552712554603427168783146418292560469;
        A(13,11) = 0;
        A(13,12) = 0;
         
        b(1) = 22553187419197934587971396520512053627215487911054204459/487579223465723414961107699584006982148892518542960160000;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 15967635831234047061893605493762796857198961531923339843750000000/43078160045172632242292128090614935511709097534676544177375223517;
        b(7) = 688508436730421000209012050616695856471636133357146000000000000000/2657881354418878313988403734255122837719316591608171887257481150129;
        b(8) = -2251678039920442444225923949659368803862070967065429687500000000/3311368434777280555931104568039169071879997280233940046987661;
        b(9) = 21681861809217191056047223189811397045846497085397312260677562625198226230175121416701138661923201079724395194831088557823704152091569988007177216154068942953589394398695198020436000312395888276194532433699146834710637779834038633469/434579305988063564283928651434370278830178325914233555106932595592854294016826951534387787471836637087648735186453365650717931982521588135249340790810046580196748330227601754641445954865075347077905636101757968113311915067377440000;
        b(10) = 10219991065005132749515123618457827629852638857589843750000000/995010906086374642287952851391769519539248509121060221133;
        b(11) = -31597753572329388402824225259303094563543903474250000000000000000/2137554682417170182613717171706225047525717006011433490749897;
        b(12) = 4325952012406538297812957360608408700847122870818137/841399339133195733506320637555298197197234546911;
        b(13) = 0;
         
        b_hat(1) = 22662909880326904499714959783466115751981393518897/488582282892501720994309015993842340473885405280000;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 0;
        b_hat(5) = 0;
        b_hat(6) = 2351177544972213708314755639490536451871408337402343750000000/6310585484423941438882581389318072490606342722009357514142569;
        b_hat(7) = 1948518792369536306029467116924317574061582976000000000000000/7535791943938005035393729346543170667844198319846475874061829;
        b_hat(8) = -273970173110980828970931537438922214372157983398437500000000/1857486901469746285080353552069411291222051523490470416613;
        b_hat(9) = 130510027690127802362195466150317932002134530792002373018593238364640073241562310557274549492653256422571827546584858422893762439939129436430764581573684543556057983068015664043186815397916781497143/5473581137551600084619473203473327228634570482204345124920998774417666916445747824289966064641140809974143823415868217503709639424875040801246236249316340092471578369140974581799798494921955680000;
        b_hat(10) = 68305290190120306981338317511482034922973527343750000000/196603617088791670082583056983159359719274552286318953;
        b_hat(11) = 0;
        b_hat(12) = 0;
        b_hat(13) = -641056739154223243123976490523250685637624636397/2868872564019663972013757653622546215480098309;

        p_order = 8;
        isFSAL = false;

    case "IIa+8(7)13"
        c(1) = 0;
        c(2) = 1/4;
        c(3) = 86021/762000;
        c(4) = 86021/508000;
        c(5) = 53/125;
        c(6) = 509/1000;
        c(7) = 867/1000;
        c(8) = 3/20;
        c(9) = 295159845764/416264491649;
        c(10) = 8/25;
        c(11) = 9/20;
        c(12) = 1;
        c(13) = 1;
        
        A = zeros(13,13);
        
        A(2,1) = 1/4;
        
        A(3,1) = 25374388559/290322000000;
        A(3,2) = 7399612441/290322000000;
        
        A(4,1) = 86021/2032000;
        A(4,3) = 258063/2032000;
        
        A(5,1) = 394117287349/924951555125;
        A(5,3) = -1478808184872/924951555125;
        A(5,4) = 1476870356896/924951555125;
        
        A(6,1) = 21806069/429936000;
        A(6,4) = 2085253894/8198887125;
        A(6,5) = 67122964561/329119824000;
        
        A(7,1) = -10767669849309/37129416272000;
        A(7,4) = 107549272780798434/80010624633743375;
        A(7,5) = -1571425354197/548533040000;
        A(7,6) = 195974150961/73190382500;
        
        A(8,1) = 122914197/1247416480;
        A(8,5) = 2834577/12772576;
        A(8,6) = -1123911/6195548;
        A(8,7) = 1003245/91667332;
        
        A(9,1) = 7516815761873698650240937021297888610305781198156454914018066425686713809124/19417750920086037142705440148991358353524951455336635926349428617092008016799;
        A(9,4) = -2970280712345026029784493078033500603558797778620788610891609609625083520000000/2059197881322255811366824379732129118957063276855086357832879720044283034195609;
        A(9,5) = 160883051099229570661648871967605637311447402857798976770144318499344176200/55373838844007112802284696674027443630749586849658020349496486226959885797;
        A(9,6) = -531291044569132007849980767445890096567679581535833821522948115776782916800/286600138103969709516639731800408929385020510549016787456022559956334619913;
        A(9,7) = 92917760295507691123384296375592154091398238056386167422408760067912000/663525387387781548392930054085313627947883220329590736767284727992793459;
        A(9,8) = 16582882008248100072444682934459438760351720266822956376058566080/28953624935338209620540938361130162616618239541632595427443431123;
        
        A(10,1) = -397907419247815925921130059686865048509124/2467734205602744466122026313943800290709375;
        A(10,4) = -12397380504027867540933244272640/71497487771289358131961402817451;
        A(10,5) = -938215172932764769802614036208/720988934849815411624418693625;
        A(10,6) = 39294182008628611505961825730565883738506112/34530663960302355453963385168366837619171375;
        A(10,7) = -44522287344548287709730039702917122688/1402380579847472465941191457456761953225;
        A(10,8) = 20222100246339043804092120397184/21662367405707901792558292907875;
        A(10,9) = -30521958981544768864151899144647092370777642374348985368652529884/364283329166067503011761408054691133551081505869170977618646228125;
        
        A(11,1) = -7874248153103427073301520825686819245245713313/410128949126757953376487799591079982676499635200;
        A(11,4) = 592147767606693369421771800000/2166590538523919943392769782347;
        A(11,5) = -3777316336297553135210313111/5593126282471295314419732896;
        A(11,6) = 160775746506894169042900490691204481389877265439/470767315337957626238784466576517627715500536844;
        A(11,7) = -507593940096706904938228151863398894238905405/7470102369519587845109530946292707809479335476;
        A(11,8) = 173196146788876378135182681744256899/1793073867682496036448646518502714730;
        A(11,9) = 937132687483187059957479559988037034595389945431346986697458481846645979573026347/7071054501415007346897024777503547537721817297910549006214731593062974677881100800;
        A(11,10) = 116416656136756811965545/315877857843708025406464;
        
        A(12,1) = 28191405932827173126309408200664465069287507375903/46277040828099807659589313374497236005056822803488;
        A(12,4) = -429380072388144504981858700675520000000/188940382517997566021881003968356031669;
        A(12,5) = 24173887609985281514926963208103700/5080791111711202068770238453613777;
        A(12,6) = -54881449674479480016593038012420742831966782264181600/9949308922521596315581680829335134273237927944004721;
        A(12,7) = 970969892075126686370480622782649944320946827348000/3347483649309697775724736894621937483768621235854151;
        A(12,8) = 77411823900067580361972977027037723040/136014860952969119034946902128158999209;
        A(12,9) = 656779806953299263849114640553093566236946159841995197013788762083697980273440465097410146645645/828556489672666107963907105193770544832899849879697116662334249174938654251472014083110713914032;
        A(12,10) = 3147129425650261440272289698280046875/20338543888980253307598069078752387872;
        A(12,11) = 425854850025102447819650719213220000/263691965699784622774911587349396263;
        
        A(13,1) = 3621456146894606285894995339383850874108700148373/4081168693163363596994878822807031005774876048608;
        A(13,4) = -3817583686059663366913679467944640000000/1283023117642128560298752783599596583383;
        A(13,5) = 193234496869635405437524415902310900/34501742641572006835386893540142539;
        A(13,6) = -87974988257716022018037206149145819377007277738400/14871674463411999056342756887683215806741009406229;
        A(13,7) = 3275133743198491987936602396440511473300401684000/14866908561378488620343856456061248578257652060133;
        A(13,8) = 8526827543558748199980436728262708480/83965981332240915696885276969279079833;
        A(13,9) = 39009210105998257555064429930449313140180415214883261536546755024187088643232941505/33878790250537583879968593309051059917530985063051045330469429477091985229650821808;
        A(13,10) = 266248736648182734031056196146328125/137973433143769650633804707559140704;
        
        b(1) = 105711409411029096011/2363345366733216286848;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 49144903996079337500000000000/313203740909075359159534015851;
        b(7) = 122908398183230837500000000000/665774200882383246774037878723;
        b(8) = 14734515405327276428000/65439093723444914604579;
        b(9) = 98855236015768950806532226039371426875067857784942240050406497922541356709067743917330653/668183874060994347945818441723205177438829897987551586564757651033104640132059340614221120;
        b(10) = 80375815959623894921875/1056804190408540040777856;
        b(11) = 48020889007901260000/391135894718289455007;
        b(12) = 1146762646211206909/27426666521711241540;
        b(13) = 0;
        
        b_hat(1) = 415143901557332051/9054963090931863168;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 0;
        b_hat(5) = 0;
        b_hat(6) = 1392529918457821250000000000/5308537981509751850161593489;
        b_hat(7) = 2142381651020498750000000000/11176065722246241552561786933;
        b_hat(8) = 4735428542080120856000/21813031241148304868193;
        b_hat(9) = 1360794378607602525113722425939330174725374220595898325328629456869721330363/10682792599936408020924171586589409694572260337238697644239411829708789571520;
        b_hat(10) = 9357212880829926171875/81292630031426156982912;
        b_hat(11) = 0;
        b_hat(12) = 0;
        b_hat(13) = 7787234078438942063/191986665651978690780;

        p_order = 8;
        isFSAL = false;

    case "IIa-9(8)16"
        c(1) = 0;
        c(2) = 1731/50000;
        c(3) = 7630049/53810000-983539/53810000*6^(1/2);
        c(4) = 22890147/107620000-2950617/107620000*6^(1/2);
        c(5) = 561/1000;
        c(6) = 387/1000-129/2000*6^(1/2);
        c(7) = 387/1000+129/2000*6^(1/2);
        c(8) = 129/200;
        c(9) = 387/800;
        c(10) = 6757/100000;
        c(11) = 1/4;
        c(12) = 1427971650951258372/2166662646162554701;
        c(13) = 4103/5000;
        c(14) = 2253/2500;
        c(15) = 1;
        c(16) = 1;

        A = zeros(16, 16);
        
        A(2,1) = 1731/50000;
        
        A(3,1) = -177968356965557/1002427673820000+14180534491313/250606918455000*6^(1/2);
        A(3,2) = 64021741529527/200485534764000-7504450763411/100242767382000*6^(1/2);
        
        A(4,1) = 22890147/430480000-2950617/430480000*6^(1/2);
        A(4,2) = 0;
        A(4,3) = 68670441/430480000-8851851/430480000*6^(1/2);
        
        A(5,1) = 592203994261020339/513126355505556250+730386990293623641/2052505422022225000*6^(1/2);
        A(5,2) = 0;
        A(5,3) = -8712153884182794903/2052505422022225000-2843421359195851533/2052505422022225000*6^(1/2);
        A(5,4) = 1873698362223295443/513126355505556250+528258592225556973/513126355505556250*6^(1/2);
        
        A(6,1) = 11380823631/157617812000-339148869/39404453000*6^(1/2);
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = -2355345717024309/58864341808507450*6^(1/2)+16193232887091831/58864341808507450;
        A(6,5) = 165912282616977/4179075230308000-33181894472511/2089537615154000*6^(1/2);
        
        A(7,1) = 26523528363/231790900000+863255358/123138915625*6^(1/2);
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = -38208748178016484817787/842517966262441068418750-86118788556282369822807/842517966262441068418750*6^(1/2);
        A(7,5) = 92362336407446913/290322814529044000-232039320950012997/2467743923496874000*6^(1/2);
        A(7,6) = -362925891/1690350537500+857800423623/3380701075000*6^(1/2);
        
        A(8,1) = 43/600;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = 0;
        A(8,6) = 43/150+43/2400*6^(1/2);
        A(8,7) = -43/2400*6^(1/2)+43/150;
        
        A(9,1) = 7353/102400;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = 0;
        A(9,6) = 22833/102400+8901/204800*6^(1/2);
        A(9,7) = -8901/204800*6^(1/2)+22833/102400;
        A(9,8) = -3483/102400;
        
        A(10,1) = 376708742472214988700853/7788456028125000000000000;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 0;
        A(10,6) = 187914666753956840195279/2596152009375000000000000-210440846556290693268911/15576912056250000000000000*6^(1/2);
        A(10,7) = 210440846556290693268911/15576912056250000000000000*6^(1/2)+187914666753956840195279/2596152009375000000000000;
        A(10,8) = -18552667221896744226647/865384003125000000000000;
        A(10,9) = -3167799860072183913409/30423656359863281250000;
        
        A(11,1) = -426968570497/54394415898750-92754382349/12087647977500*6^(1/2);
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = 0;
        A(11,6) = 1/30;
        A(11,7) = -2865012129681958/114898584332330625-12962517687655099/229797168664661250*6^(1/2);
        A(11,8) = 4389715333607/309890657317500+92754382349/11477431752500*6^(1/2);
        A(11,9) = 371017529396/9306344041875*6^(1/2)+4990058173976/83757096376875;
        A(11,10) = 1099523524595993125000/6257667909869756018891+100957348037989687500/6257667909869756018891*6^(1/2);
        
        A(12,1) = 18382031104798403869938539009154656587521498573595595063164077882800315372787284683238439478955141517997198007108623761931447163756/13974256944499724344918960993890933614161025322970450047932688998095008528620821239604734608111291769444706187497807869179550841329375+407885778185158609210793892517582595305896470756467612636796259611491408260896413446883450891351622914818800693274034252252905536/28084926388601226073624096169175002956970191576455110633226765141161372294098693275117181239385312198137508846535933127837167926875*6^(1/2);
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = 0;
        A(12,5) = 0;
        A(12,6) = -333881311789849411971573472868128281438202210721723123251742145367734582887577395547778228760174068758086134389952015563403904/2270872004608103037127689848604039623086639035441372934050180593816493796129405349914148981460714202232988727738778494557727635+4819272892477768171373308666720689121421091953625792970278044071549950640195056472955523769829034800621890424847009130000000/23162894447002650978702436455761204155483718161502003927311842056928236720519934569124319610899284862776485022935540644488821877*6^(1/2);
        A(12,7) = 169845085565361336805556009296394374527636952379388961026066628725155521832762086875632366996477567928657535912191396155566765457826139904/1593979913718173260623679425966077497797978183146596135797795272107637620098614087434873732933937315094489187314474045293119200999609586875*6^(1/2)-136666607496463622270135608863772076443625468798139480390426740993024803946981763209348364716108721312822619845726151693667598437699964416/3719286465342404274788585327254180828195282427342057650194855634917821113563432870681372043512520401887141437067106105683944802332422369375;
        A(12,8) = 5610987899273278525411960528081442902198567594809764379756195673673265700551076812883925583370253765702553235594764427173637673766208/92881598198144033018278804740626334135423356791639598109358867770361609232846012626732332450844264293840456574956036349633197336361875-5587476413495323413846491678323049250765705078855720721052003556321800113162964567765526724539063327600257543743479921263738432/365303089362201664516413596925286161494473575337115296250511752859728108868696929614024803255122785403232359817965288739565550625*6^(1/2);
        A(12,9) = 54598539818083615233566148602203244896696958910734339754065270985433507945162707737759469214674480807272210648148477499238783276259328/301247919092298852634886875129959310794662932014184499827145075851637298698312074030567479239502011693447423026416040794479934024058125-6526172450962537747372702280281321524894343532103481802188740153783862532174342615150135214261625966637100811092384548036046488576/86490932843037281836028387921320502668579653176624892284566487468170341285762869374265713247057712228954184044334206372230816544375*6^(1/2);
        A(12,10) = -8108825145085088104344721048166325225173729495689364696426720161112012414227752328969720658987315654179873760357725235734000399440000000/265558296661064021061274102756797754810572081529546692522040189640618206693081506133206500662983001047298787619827411375675716583283801757*6^(1/2)+9391667348404584010955422210328707125006120661611061908889750805619418785820948002455890360939221912190524731087070645107486913457760000000/58157266968773020612419028503738708303515285854970725662326801531295387265784849843172223645193277229358434488742203091272981931739152584783;
        A(12,11) = 123461712659887915177271339396606860810479028777869348014870450606260914019560285661288212498128400476015695960341952/281629106670320674754245209358840703704235147307838896741075511220826056829047205614324978253226176275078922716132461;
        
        A(13,1) = -56042772675322042139227629978042586330633622706053363946766144416933631/58808540772323190525590122613223430507352118534557342666015625000000000+281404579734699232141455524604487724159024972527/1478009944832743180452316204077188415527343750000*6^(1/2);
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = 0;
        A(13,5) = 0;
        A(13,6) = -1027163900229750356561238237947225332675621517/179261894431132664078747698292867431640625000-2745292391641202525373103979336813513372321/11702216468464340311060649744558385937500000*6^(1/2);
        A(13,7) = -157229999853748227305165773364426925282378072238332930121/36699907367985458573273204094330716033963413238525390625+5757606442802795095318986067317837904184278650664590252101/3523191107326604023034227593055748739260487670898437500000*6^(1/2);
        A(13,8) = -9311448168593934146015965019904013602133802943325818346622781285907057/4255970849010124217193135449668739985401313363005576159362792968750000-844213739204097696424366573813463172477074917581/4210188359946578336976868164966163024902343750000*6^(1/2);
        A(13,9) = 885774233856672590222951867695327816457340130391639153070521335485617578/301098541380295011015469248465465290112505656143757799934635162353515625-281404579734699232141455524604487724159024972527/284481916364737983221402322504830303192138671875*6^(1/2);
        A(13,10) = 315479116729780153956412124052199685097744239386639023787359107959254802182/134481850506505848012587842215515574380212543200894932329128471154748828125-2940396453647872276646068776592292229737651937934623/7345465058781983710795837429530784777245286520703125*6^(1/2);
        A(13,11) = 2250996163406545378616532039018846586217631599453822541/382491303797095993563304148204275636433504028320312500;
        A(13,12) = 2689340957307691853294902388334454003959378146957529866233529251986359392336044151708949720958809747970514366293458424272174024493/959516386019578808500569114780871708466894752280482835105408027815194895319055443842782227102120493960805649575561796875000000000;
        
        A(14,1) = 47342003848024391498707976847688893013083074441159779465719863625051668939887702630319/44802546873926050730401222636656855760802419993852060264615320801485392456054687500000-866369530987077991125562402829092187100493209601/3325522375873672156017711459173673934936523437500*6^(1/2);
        A(14,2) = 0;
        A(14,3) = 0;
        A(14,4) = 0;
        A(14,5) = 0;
        A(14,6) = 871779321807802447463310035318238762878527157/134446420823349498059060773719650573730468750+107641268480999396081848975271849857994818/1097082793918531904161935913552348681640625*6^(1/2);
        A(14,7) = 496103786351862292800034805114190705484800743513354117014/110099722103956375719819612282992148101890239715576171875-1329938412606197485769312599390307351191540891599374831099/660598332623738254318917673697952888611341438293457031250*6^(1/2);
        A(14,8) = 40774077277747636354598451708891165494123131383777235229538611989392175193285994266471/15264290546248162101058985941588079518256741255377031736357946125713524703979492187500+123767075855296855875080343261298883871499029943/451091609994276250390378731960660324096679687500*6^(1/2);
        A(14,9) = -10522038608500556459828649038302068473735749030796372764961618751973793724796364606986664/3899417425005422254034574000397382862235892829653375835197340918271556055507659912109375+3465478123948311964502249611316368748401972838404/2560337247282641848992620902543472728729248046875*6^(1/2);
        A(14,10) = -27843764471262693189365201135620670490328475323282820219474851621693895769527094334687108984/12257041066285164222002594300605593929434139193022166317802121412999357024704596261133984375+574774300271998598683873114105472016699241495055292/1049352151254569101542262489932969253892183788671875*6^(1/2);
        A(14,11) = -34241134351848245624232809437676889009431930503529853032576417589898516/5613347824358651981100985009024281007603230062439942682713165283203125;
        A(14,12) = -3432044375893932378102368568052286501033850910516999202088532705211633432793920547702800961532438008401883737341854688972639605334600163938610268855705742764072609/1143174106341682260971647690410567292143926198650927778920823267461111371275907599801714870165813394147519068210931766844494994616580258435518181434575195312500000;
        A(14,13) = 4746930876023919335079451612726717649218264199984/18592065538407049755200144388134089346432755594877;
        
        A(15,1) = -25188329249258825443748527038142409879923012133738985313265430932280250855708601/11370641325574469312056961874077298550827642308774647316995717036347558064286250+1234273058981860170179592598535508631343082535549881956/2105633771469628744518390642968552144069898845895808125*6^(1/2);
        A(15,2) = 0;
        A(15,3) = 0;
        A(15,4) = 0;
        A(15,5) = 0;
        A(15,6) = -54821142119685055562477216205428613949905430396088/3959439837009461289085587746748097947393101278095-1511276753825982856072891469504471256664975925000/40386286337496505148672995016830599063409633036569*6^(1/2);
        A(15,7) = -60922424274061599918603524049390657305431262635197540405697952/6484861747489032169774584624759953148531564032417461909516875+84558575751635978733109961893984238786929550462615375699341616/19454585242467096509323753874279859445594692097252385728550625*6^(1/2);
        A(15,8) = -116118147575045169733222875835719955334334798191459879782123534889390467935109772/8810626901954835245672275131295870892503713957512170681453300814988417642493125-176324722711694310025656085505072661620440362221411708/285619406719829107485771207042040133465420149964555625*6^(1/2);
        A(15,9) = 17769448722513898342276837490665097286927607247073335618566987143467294900183033216/2551217008137889615056342146084561867122485163596619283719957742418751029506356875-19748368943709762722873481576568138101489320568798111296/6484554262322259071286545935997129135111813687175650625*6^(1/2);
        A(15,10) = 97659266139124074818193264801929547781659926543786381510190954184218570746215033823993530000000/18560076654469706205963482908787056850812308205603127326855360961727608242796551101182080033599-85297084611782122474911131363078900058888025224607913745000000/69210659450201393843166746722954036326338355649915383851733911*6^(1/2);
        A(15,11) = 473389749049752963256114649231353822492912259509649519870869750525/35412440882360341799798842428365422941216508121322622479260846291;
        A(15,12) = 33351439245158438248073494056784144097872912773415904536400728387690334563968394114702414108807505158106385116468732853458202899966748488718531545706559142895903144848764637/2316611025327287427714802011322252886090793904989900621592365627649097578102163572190502232425490606773312310665593424982745744299371285598588298606088543376742054644818966;
        A(15,13) = -38714992656958413389743252726016897599283911682945255636643554687500000/48540494926971587499294589382572212036169135429877901702347521300421767;
        A(15,14) = 14800250200940323717124616175641261235119295795768814717803955078125/33565577125141877760287380588632421223433194078156948298488471160489;
        
        A(16,1) = 2305785696086397561080858186939897173645641331085041313944389849986584101287/617508244345282265819087370078275122671246164669900462139876057008239440000-85404623305589712632165905233974183137607899140719/124822287169084833758410283469525117460541643292500*6^(1/2);
        A(16,2) = 0;
        A(16,3) = 0;
        A(16,4) = 0;
        A(16,5) = 0;
        A(16,6) = 102903996961580448264190625267026062654799259083/5046398084890004857481629999673320438819484730+41320925487304219313300272052128374567081128125/51473260465878049546312625996667868475958744246*6^(1/2);
        A(16,7) = 62798443349876457506718920843975661399949564598018488144466/4132553498782573324058263582553715220777051359780141380625-72308807081932961554425711089716771013571419950657300729103/12397660496347719972174790747661145662331154079340424141875*6^(1/2);
        A(16,8) = 1794909142126482564390848522924225553221469019751470544959297614654661293377/52596481193994264435601626109752988674679691644275456716633975785978672500+12200660472227101804595129319139169019658271305817/16931561456559959115207709344056578263397760602500*6^(1/2);
        A(16,9) = -2775244732780109667342845612394739319115662636371477300455747022423270475907256/228417153675584029725018045422706955827996328208181619436454383447149337555625+341618493222358850528663620935896732550431596562876/96101338378773357469245211954911505447551097205625*6^(1/2);
        A(16,10) = -27680554659769016623530979176727448251292244310769996015342190819068970556083063125000/3299557777429648960576561382256606844677258438797072955341581354051375036522231471437+4426552127579895373479670356100179759944766558141730312500/3077113738667320707748877199804636746494977000658967987677*6^(1/2);
        A(16,11) = -292603171929706291053929402159930330736639136252680853622275/15473622826279161150227076887290262443510550964275858143964;
        A(16,12) = -9815717129569106988569302193220999343824932084582093647596086931754666098662594153095258988516305165794739744873539829069617203523509136682216933020431/286476991170934153076146641094402171801937250068596542931028678669501762253287693294397689327797388113854588113430063939405071979092547998950955940992;
        A(16,13) = 2729491144709837905799148766650782532906050298971406518524169921875/2158115888622139473142775812109447802920656149243127309253686951469;
        A(16,14) = 0;
        A(16,15) = 0;
        
        b(1) = 8198160366203173411119943711500331/561057579384085860167277847128765528;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 0;
        b(7) = 0;
        b(8) = -455655493073428838813281446213740000000/1163808011150910561240464225837312497869;
        b(9) = 19965163648706008081135075746915614720000000/86394404190537086868394686205782432516544599;
        b(10) = 89231107919981418705566970804343750000000000000000000000/699979870988335674445594679856445060562597693583175985391;
        b(11) = 47104273954945906713184913871143492/209684639122339601934631113492763467;
        b(12) = 20845004421404500464010584740796750650832176798370383084226351294730731196673647311062330972740734737279503119387627146381678677156136042524139311907482802844083/36670849891136373020238225328265100250605144718501926305140966586758054847604681466336103169284755987753542321202462371554120593858149755539878561976786592389608;
        b(13) = 6053037282142306509795911286909179687500000000/103899257350518063455290077573775162739725126989;
        b(14) = 917401104920993498360358406096725463867187500/6724249815911346653315790737453607382989551463;
        b(15) = 2585449557665268951371699596493957/84574345160764140163208606048427531;
        b(16) = 0;
        
        b_hat(1) = 552562031208180939317806684253/27669654257734667858523344041464;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 0;
        b_hat(5) = 0;
        b_hat(6) = 0;
        b_hat(7) = 0;
        b_hat(8) = 221223388631423597589898601690000000/100946136798587090054685074667127461;
        b_hat(9) = 101835408791305297984657812561920000000/1149763833200743759976506650241312100139;
        b_hat(10) = 1313720309077630014453239843750000000000000000000/11518201923215510989126466531107437037395719117133;
        b_hat(11) = 4833611232701440504508086151728/19081321241454145230196661524503;
        b_hat(12) = -2129662374582324648106919795703373645353118273066742230724172731025813964712473647144010599206669825382719359113196238857709025512340589957/1035543739272367080885190546201097218891268728118207332592595987554851882972292670881794178380097716583123063485287435793657425889233080568;
        b_hat(13) = 1084761591753640855844358063964843750000000/3182895486031249071938549691320502488733423;
        b_hat(14) = 0;
        b_hat(15) = 0;
        b_hat(16) = 1839190071060649887127895100784/38045139523510634351420875415397;

        p_order = 9;
        isFSAL = false;

    case "IIa-9(8)16M"
        c(1) = 0;
        c(2) = 3571/100000;
        c(3) = 8354544587/55941650000-13780579559/671299800000*6^(1/2);
        c(4) = 25063633761/111883300000-13780579559/447533200000*6^(1/2);
        c(5) = 3067/5000;
        c(6) = 3933/10000-1311/20000*6^(1/2);
        c(7) = 3933/10000+1311/20000*6^(1/2);
        c(8) = 1311/2000;
        c(9) = 3933/8000;
        c(10) = 3429/50000;
        c(11) = 253/1000;
        c(12) = 323784232998090123327115000/489052637196691756275154801;
        c(13) = 8309/10000;
        c(14) = 4499/5000;
        c(15) = 1;
        c(16) = 1;

        A = zeros(16,16);

        A(2,1) = 3571/100000;

        A(3,1) = -1063961896008469605553/5364158860350742800000+58400885919203389943/894026476725123800000*6^(1/2);
        A(3,2) = 1865066339130032648137/5364158860350742800000-115130466360366297133/1341039715087685700000*6^(1/2);
        
        A(4,1) = 25063633761/447533200000-13780579559/1790132800000*6^(1/2);
        A(4,2) = 0;
        A(4,3) = 75190901283/447533200000-41341738677/1790132800000*6^(1/2);
        
        A(5,1) = 8317677327336563663145090361/5536832739802692300423375000+1325183328152912742409776223/2768416369901346150211687500*6^(1/2);
        A(5,2) = 0;
        A(5,3) = -1270722105973171521192787607/230701364158445512517640625-1685619746948466766837573433/922805456633782050070562500*6^(1/2);
        A(5,4) = 932918978173121889525736019/692104092475336537552921875*6^(1/2)+3196993302326815537820188804/692104092475336537552921875;
        
        A(6,1) = 5196771085177917/68224033868560000-330761997893841/34112016934280000*6^(1/2);
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = -8105178255989753296919889/181596084858698082517721750*6^(1/2)+26242377340395097381401738/90798042429349041258860875;
        A(6,5) = 18016759921684339490877/640968377737806903920000-3596041100280733250211/320484188868903451960000*6^(1/2);
        
        A(7,1) = 223316714112024537/1705600846714000000+9858970533386091/852800423357000000*6^(1/2);
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = -166698286062826975533079550960340114/1518464319946990844389415004696390625-396819750241888772849615854923681483/3036928639893981688778830009392781250*6^(1/2);
        A(7,5) = -22636530502925542226259087753/1452639133350557673588522440000*6^(1/2)+304540438841751149890259236479/2905278266701115347177044880000;
        A(7,6) = 5065949973255093999/18950437731231031250+30356655006512719437/151603501849848250000*6^(1/2);
        
        A(8,1) = 437/6000;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = 0;
        A(8,6) = 437/1500+437/24000*6^(1/2);
        A(8,7) = 437/1500-437/24000*6^(1/2);
        
        A(9,1) = 74727/1024000;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = 0;
        A(9,6) = 90459/2048000*6^(1/2)+232047/1024000;
        A(9,7) = -90459/2048000*6^(1/2)+232047/1024000;
        A(9,8) = -35397/1024000;
        
        A(10,1) = 34981998395287042773/712288260957031250000;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 0;
        A(10,6) = 26142065863151592321/356144130478515625000-39040920222453600777/2849153043828125000000*6^(1/2);
        A(10,7) = 39040920222453600777/2849153043828125000000*6^(1/2)+26142065863151592321/356144130478515625000;
        A(10,8) = -3871748199586065417/178072065239257812500;
        A(10,9) = -4700908757069746704/44518016309814453125;
        
        A(11,1) = -19337287919927/2381350488750000-55296516975959/7144051466250000*6^(1/2);
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = 0;
        A(11,6) = 333/10000;
        A(11,7) = -260244255383067959/10245064962386250000-2619008933532346117/46102792330738125000*6^(1/2);
        A(11,8) = 97445611354781/6793342222500000+55296516975959/6793342222500000*6^(1/2);
        A(11,9) = 220980303429416/3672420594609375+63196019401096/1573894540546875*6^(1/2);
        A(11,10) = 1077382208769544763033/6028830579467940860448+42001488504902501123/2583784534057688940192*6^(1/2);
        
        A(12,1) = 1457432992630593801148119211375519786773130047948821068127278449366088369906297154581799875457220921288649759335254064232368444050896709221583989959285015270121988921456933238005000/39076210129062923590101056700391485300304598601841278626585287226104976009559477781012524299388768324528252687407545497364304696689898469433223154794450108480183032526715415513250031+60653289279909219220701742076252899782776129387468610116851082147611711777844378990014005965085662046217817710192191245858611197953194435888978092465800199999912611181829592480000/8009409529559481232753632739831795123664917725843243445200711046344498188294799793623685104843660588257343718536950319335540714228364282554635801914390394905876025300506886409548143*6^(1/2);
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = 0;
        A(12,5) = 0;
        A(12,6) = 956403431434719767035386971012537772009433295910971396120623385163028261779756189353648677114043452262118046249623003010124768564742160782947507423873383747178959069135180000000/13928204251958528871103062885334446009635157143976347652131757217431539357284412546292659579834627898312134394915362446810127723132396330765868076301446848555847618605808935894681+11888562497806574712316000784096684919305626390230092557039625014734875474132957288812431148270311684712679542654190470394752883570117096172317980970791026200828707461200000000/1266200386541684442827551171394040546330468831270577059284705201584685396116764776935696325439511627119284944992305676982738883921126939160533461481949713505077056236891721444971*6^(1/2);
        A(12,7) = 12273062973696276994663513279707815111463555438812213808628869225325619485817613714874169792698975765719895722229939130765045583407020335852727206196967008396603283484499755854833120000/97329147000747394105817267027919003080055686517880309652113299557884417521706805348862328152221004918976286454732212626689200391913616629356500563506768127259284438915674756255771270261+768749883803558761981522189454279035313635641300450966189472961003290030942976327240714992427742198169827595944215053480338794977143688597696929624565906247107358807407224539125737280000/16643284137127804392094752661774149526689522394557532950511374224398235396211863714655458114029791841144944983759208359163853267017228443619961596359657349761337639054580383319736887214631*6^(1/2);
        A(12,8) = -30326644639954609610350871038126449891388064693734305058425541073805855888922189495007002982542831023108908855096095622929305598976597217944489046232900099999956305590914796240000/3808109459422127219733451709003335272659192436774502157137812552510055471852810906057494298414537176744110831861983475441832374189844435304240663669027259792421467847261512727627099*6^(1/2)+18237041792237133199626952877820450430043680844627255426032285464589243268144350669553764254256040691817318992214419543374812150660375314309234689943417797453119309690179619444240000/613105622966962482377085725149536978898129982320694847299187820954118930968302555875256582044740485455801843929779339546135012244564954083982746850713388826579856323409103549147962939;
        A(12,9) = -7763621027828380060249822985760371172195344561595982094956938514894299107564080510721792763530964741915880666904600479469902233338008887793789195835622425599988814231274187837440000/197628501279235388632852759546348309599931473859979873040241166789198497291756989133481007009541346955924641202010157354523407492023235223874360036213081633884883238451614800882315203*6^(1/2)+992157017453807065158086266797061260135256600886827899464111259722925575025216820972795390572461023485404899854599327480149214586639714463775181460151230155492219611387936729108480000/10606062901985632523296431428987359281862989097152253186492942617686986021324291750163480709512052286634622411174545111359422868738580290347923988610102047685155400463569994314017582561;
        A(12,10) = 12351634923868603194837912835873374792353441880136700558951300708387900894682507009774830382142395524168240237566671014513088354511398637460088305901137048255441622143947664501056250000000/151902027932673128109007914019209574877886858584408412194819654440122547823180260668437630048095967727338454889954427077685033987397085888511035382435827985234213740331526884824980028500579-1035370602160950343728385206536035828323170646184522758635309488222903048707734125727973461200876340398327591381015139626570823965060389393886071344045104976561008245564825465381250000000/65100869114002769189574820293946960661951510821889319512065566188623949067077254572187555734898271883145052095694754461865014566027322523647586592472497707957520174427797236353562869357391*6^(1/2);
        A(12,11) = 315874204021067370592802058736183361783040988156478698347904604627043638500716444515597812727899507424760415901441435749705372168901960955147880512367824450551123400000000/1401412344136519474355633240366809473162527856432637623217359028209201730618691389670194956240678767285564506927055328192628961211531411004313151128397778797615060032131891;
        
        A(13,1) = -326565433940040567279553983807940971066377444151947913889131479616462212675219249339/343707809253307564840329500713215636563133723537576997631038626745932843750000000000+61643974899098681305983146133079461286991586962643718927/321354772521404134611844118223485351831140365410156250000*6^(1/2);
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = 0;
        A(13,5) = 0;
        A(13,6) = -5670952352330372272561883598911434219542626795444401913/982901386469666539460198632816539623798483567343750000-17218199550958937925436983143846915004405992808435461/71483737197793930142559900568475609003526077625000000*6^(1/2);
        A(13,7) = -7820588228554926646707575071548114880645649291546303235318948359/1812503452434531758718630493142385726564159871812718769531250000+11953375844794747770831739167280618666705869111004559501488371121/7250013809738127034874521972569542906256639487250875078125000000*6^(1/2);
        A(13,8) = -46349717177040747079937388167147800930560121732085006123876040279466776075859788243938041/7716381146050272970914775930575770022742012339009284388172569098024453106690195312500000-61643974899098681305983146133079461286991586962643718927/305579117799589311244586289925355663615457864726562500000*6^(1/2);
        A(13,9) = 1304479156149931374671932146415940535715990003255433875017201335741256087431490964479895672/433243012755082016523571444412931701444035635819325624041518370720375964467404410400390625-70450257027541350063980738437805098613704670814449964488/70797155429174172044571300980009978265948410555419921875*6^(1/2);
        A(13,10) = 53499973771070438931341432028748933511031756369002959884509452314143937179198430370871621/22922569363179242812845404238454494018433496012704011952165038188274288884136862213500000-3848345290129446247244947837165103511773617643239329310157/9552410246640836349521799149768718292125508211506609500000*6^(1/2);
        A(13,11) = 1442468622510382712945480782192996973263909850553549618200360607390784489/242969074956448399838631272662435028659031254083070644662796080909015625;
        A(13,12) = 125793571551570766313348508702484543503002426635529910570400934107035739451387509809562407887952649018068290632627828723479514440439234850700112165456435735142668436782818331196743957/19087551225496644744787541138299822844188785570576097340571251605735374188933440818780277195208581217529525853515353636480581940080746454292393963794287528840772677081656250000000000;
        
        A(14,1) = 665443592515357411027502758497136037145849170495949917633726305961813081974858409415326056502692500143/724820214552374002344022255214817033261079108600471127433092191109834485538510878083823640625000000000-2741015678186732995784743468941063074404833579456611633/11431592698389870401211846102811731883321198769531250000*6^(1/2);
        A(14,2) = 0;
        A(14,3) = 0;
        A(14,4) = 0;
        A(14,5) = 0;
        A(14,6) = 19192107301841456016024681829439683526646829185340897/3309432277675644914007402804096093009422503593750000+1767575501772250528497463426810447181569738356669/27578602313963707616728356700800775078520863281250*6^(1/2);
        A(14,7) = 22617963832873116342580238532701822124865848802195740190851473/5681829004496964760873449821762964660075736275274980468750000-46633492212723292495221019439040399829044133183961741099333801/25568230520236341423930524197933340970340813238737412109375000*6^(1/2);
        A(14,8) = 101175145664975670607850516704665286587613787692005998981105995291024270192967973330778823170182261043015843/26317493103853138075989816240231588506705072213135417106229909534782185217421308295978706249566757812500000+2741015678186732995784743468941063074404833579456611633/10870403399985390518582120985486960365767275820312500000*6^(1/2);
        A(14,9) = -52721521840973524790939372640035829481247781377434622276653785022643527282473241219036440143701109087975790088/22865182440766576535008074901073430471328018269544720503912714368446170409158033452426884115650300755615234375+3132589346499123423753992535932643513605524090807556152/2518475884832282800004512683083358910646386146240234375*6^(1/2);
        A(14,10) = -556663645352913485768732491261246626678115887814229964119993244624081365042291868922195117341671954166296341/286156915898269229223336082391998423166320303661018803305408154730346541173166416814857961518167700184500000+135714032420959868673066288701116379117453114813391150361/269503737366042404845442609241123713570939103145954500000*6^(1/2);
        A(14,11) = -4961706522310732344620745024161835260942388307859032056354292817063325272353946742440282/909633831715516691653653419053882649127359988022387066459197643369309162016909552703125;
        A(14,12) = -38476334730323289583584791222007849347224132283235154817322447941212540001985641760792800158497735316199002266252613766026844906407561627425564330559439917209764276662643259167386982128238759424977365735091743492720071398119/9291996734494210052061991818720591542147172352233876931684329599320690891362147236650658620346364780667482614441390733098031901826291604823240285191792151811432112630380758560432148941876727526027877618952683265625000000000;
        A(14,13) = 2154295524692373322906304357775511972295442931623979984390727718/10568977477784795203388208039436530624523992684505043146746375605;
        
        A(15,1) = -2349030122028994241011490420881356677070557136624103300729302186473579702235478180123352010637692061/1222092459997694992337447742361108747601859808413629519125724903529272841066800601171797941411530000+14570636562553633757444735157961349304600984257915184667273719304/26686041878037176770306921008357357216104267948408673340156798923*6^(1/2);
        A(15,2) = 0;
        A(15,3) = 0;
        A(15,4) = 0;
        A(15,5) = 0;
        A(15,6) = -525027370388193475554538976044346646954171705490024626286279000/41986830918211213176731957561151129629404840677930758525317899+143187478267729811416233519663824909208309074357597390140000/3816984628928292106975632505559193602673167334357341684119809*6^(1/2);
        A(15,7) = -139872847058224483332947298280474566841750957465037454589686067126760152/16723829919689027604591859772170214478725964016601773263028350194362983+597509031902060952802718463153133934149903014353982514083358241079917648/150514469277201248441326737949531930308533676149415959367255151749266847*6^(1/2);
        A(15,8) = -229029134800984869965062408304152756976023050576736958094025445104494263753432841093008152489434584252/10895962391244125396223612429592505441362995838421708068086245686655164891659338629446860892299512971-7285318281276816878722367578980674652300492128957592333636859652/12687997552783107959907762287535319737918341065001149150063857639*6^(1/2);
        A(15,9) = 12258775303736585364646498863486511421605878335641441705063676295938271472985970161091605248675817447105536/2024550679938947587021970056623327022538008465219397307675335753813723445246988723845310351185392852367489-266434497143837874421846585745578958712703712144734805344433724416/94066546567464379009244606074078558375926592794521911537613073369*6^(1/2);
        A(15,10) = 20909561927255518050826152883123176023984606376743601359093332350500609924953649475240757880679899292944687500/4566420215839271899552961166331798046430906280470165156406863873187412923197271686943016205681207090034515513-35532188492388046607161547232305299364456641298598971537938701650937500/30986491808902704343289841148122600848790916686534120530621166549448893*6^(1/2);
        A(15,11) = 153141086761183978196042199033746611313160314960377147674626439549610689868702427892315000/12595811072854132688687454348702855310839184769271305148987720834422440260417744025487147;
        A(15,12) = 36106773711535590474612515263754616508185155287922502807429458231268815853447268493343852624202919543148584728929151887704411516533303524318063186012604960225824460147266901949787306357896504768709612084918530762574308893065101293347131124023497611297/1624208920455499318285281218267114865080886542191313016980591625838160477819514713336862847803713124661385704616327444925278756530210061779014697129024814011983291295117620601236159125358487542534090901658452724424333444770228641184307988947485810000;
        A(15,13) = -1612444977339376051169160601219827215699524160053402059577790108436134428394126535642187500000/2430400066712145349092246612246743058955010672138419608878948634093908762855458739421396511213;
        A(15,14) = 2465849228081476571024593755044731896259144346122001994995043211977045963063083342578125000/5467971042393137656896412612102209711639943942152179467587325353682263022229941231525961441;
        
        A(16,1) = 6859338182708460261432346279500160337903879070414333210463257628170175902302376149576933652059/1911204054020197860405619747037548152674434951107751246726489589994628366689390064111713930000-126357280698003073151200609570673552544194023960168229362549624/187760031620494697497155846257146195371766906402790180931562737*6^(1/2);
        A(16,2) = 0;
        A(16,3) = 0;
        A(16,4) = 0;
        A(16,5) = 0;
        A(16,6) = 5908785051681059559441593079128007622523725892486247155849000/295414686706905093470209090993569328341279853745717568981681+21668120577506508870234768830778080296543347588226513660000/26855880609718644860928099181233575303752713976883415361971*6^(1/2);
        A(16,7) = 1752983555816158514966716652350749819098788236577022426500641239590312/117667012923369760774127083299021437702420604011024148011131707983877-6085027846871380484192478742083338186504823401885513777211910605261488/1059003116310327846967143749691192939321785436099217332100185371854893*6^(1/2);
        A(16,8) = 14592481149251594185989515207529372219107322507895018521342204685841025093990490075155974503318388/219664135260048875254752018088383728884128965193909303594494321571367401826394015234235463062501+63178640349001536575600304785336776272097011980084114681274812/89271343895775208074131354529377081905639344727913558368452741*6^(1/2);
        A(16,9) = -10180135470153597109078217030462079889252932716504334931453759044019144877730640354330046031128593408/872451405366483187563602680014916736342194258588596981123381568105690031187743507935967416647009333+2310533132763484766193382575006602103665262152414504765486621696/661841791250195219786562471189888032504679672700648852994983611*6^(1/2);
        A(16,10) = -6208265407137487991695247078612292550731402970587016927654462117106668617484780767448652109775166562500/773052291798029060783924765383499373154072053387268419361185238426339506016219781882366284470555583827+308136895452161512093050593651698339630651721376079889684342554062500/218017520486470193557008936505159870233419930267647791349217509360167*6^(1/2);
        A(16,11) = -237279888435319553164269725148051729762288202116294131473192299349577040049146816270000/12660390006417948765072963484999510621579712498049191896487117956930414250632213365799;
        A(16,12) = -3926330863291310640230633189648104409987342014309292680695337963577442514278068806701211181137910517056514237875672074647178530615197497544359162823845323262091647760685688230417273136482769255794046467822812097343864629/58974178484494100824682465908674603063377878562502649701764215873574293497624514620004003866590264450497679100499119800405964154633694238570758832157922123679162510628198405264860357407926622340971710452730353747830000;
        A(16,13) = 1445498757567418033480841284603253420379320385911289278680105343973904513610807130468750000/1315386567606253617589677981406671962956736846408261774517923354463687214464913510399864019;
        A(16,14) = 0;
        A(16,15) = 0;
        
        b(1) = 736505091445827703827933296736901282710515981/49078449950922619655089142696786170158823110000;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 0;
        b(7) = 0;
        b(8) = -2558150082544702314902501470312734979517107600000000/2424370890046508030920433479408135741643814473770689;
        b(9) = 1074181976381559790164859426515292833517450821632000000000/4504007248688852661026073125853346204743508775510330986251;
        b(10) = 12180753857030115670495978278472203643423175048828125000000000/94559927643698229839228971096164091332277926178455356342317593;
        b(11) = 14361255542493609524864340896887714214192679925000000/63081392228746794065215465697946921789295257617129697;
        b(12) = 355831704505424202013172967916219621058293130454008503572464528304344989614820627519693299611175193386214424700624797114585648391735824158513578986751501063762314180678720855919597507418898877151830513837770978527268916017999987419/289404045196571015419955683563576036880029956149525367272065421852557834869802953689103811983148796976221099390734926017275597880997861696227342468053799366196673911142245696414314716899337356105629306878981751050269677325569110000;
        b(13) = 15264878315970750767764307370152493110555453125000000000/330053088455910029828227941438075058857420172513949308809;
        b(14) = 21134127967198717119331084762787794251277619140625000000/152461290453146506992721592820379500254163255818277095199;
        b(15) = 3783514358108159245489484783038122155976517663/122840969715777954409724097594671689400464522989;
        b(16) = 0;
        
        b_hat(1) = 3196411338543982829389901873077910027867849/168479527380856094738519444687789327309190000;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 0;
        b_hat(5) = 0;
        b_hat(6) = 0;
        b_hat(7) = 0;
        b_hat(8) = 801260779572988695703888402386505737800000000/235104120941256723508787221854989883210093663;
        b_hat(9) = 27041475510215393797696128021144620508971008000000000/214559732282735268962676084474751593700989917373214899;
        b_hat(10) = 3138740423204239407602590975128218287963867187500000000/26412035389644161828211380784980108134365885547407428997;
        b_hat(11) = 462757008345682110330757437986457373922150000000/1857684490053502784851885198867594952124606343821;
        b_hat(12) = -75426017278282777697685256191955949912043661760377760312528578075763093617968889057686868278654051169575572970856446129346663231383865634651798982735396672880134639687495500072107772098594939054084472147/23066298611464245435767720193006956304721095564859262418218770129199583300338288197281082428795273065540502518866799635090738226272671152946972339235256747457382729994245276263157368080741285790393570000;
        b_hat(13) = 16094402545519370947442129724448261589367187500000000/53225784301872283474960158270936148823967129900653009;
        b_hat(14) = 0;
        b_hat(15) = 0;
        b_hat(16) = 26620387495518492132267656506620787367034797/572113631410808836239566655464206138258983141;

        p_order = 9;
        isFSAL = false;

    case"IIa+9(8)16"
        c(1) = 0;
        c(2) = 1/25;
        c(3) = 48/335-32/1675*6^(1/2);
        c(4) = 72/335-48/1675*6^(1/2);
        c(5) = 72/125;
        c(6) = 48/125-8/125*6^(1/2);
        c(7) = 48/125+8/125*6^(1/2);
        c(8) = 16/25;
        c(9) = 12/25;
        c(10) = 3377/50000;
        c(11) = 1/4;
        c(12) = 57617028499878/85094827871699;
        c(13) = 1623/2000;
        c(14) = 453/500;
        c(15) = 1;
        c(16) = 1;

        A = zeros(16, 16);

        A(2,1) = 1/25;

        A(3,1) = -15792/112225 + 5536/112225*6^(1/2);
        A(3,2) = 31872/112225 - 1536/22445*6^(1/2);

        A(4,1) = 18/335 - 12/1675*6^(1/2);
        A(4,2) = 0;
        A(4,3) = 54/335 - 36/1675*6^(1/2);

        A(5,1) = 4014/3125 + 252/625*6^(1/2);
        A(5,2) = 0;
        A(5,3) = -14742/3125 - 972/625*6^(1/2);
        A(5,4) = 12528/3125 + 144/125*6^(1/2);

        A(6,1) = 1232/16875 - 152/16875*6^(1/2);
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = 29684/106875 - 13372/320625*6^(1/2);
        A(6,5) = -284/21375*6^(1/2) + 2132/64125;

        A(7,1) = 2032/16875 + 152/16875*6^(1/2);
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = -33652/294975*6^(1/2) - 7348/98325;
        A(7,5) = -716/21375*6^(1/2) + 10132/64125;
        A(7,6) = 2592/14375 + 2912/14375*6^(1/2);

        A(8,1) = 16/225;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = 0;
        A(8,6) = 4/225*6^(1/2) + 64/225;
        A(8,7) = -4/225*6^(1/2) + 64/225;

        A(9,1) = 57/800;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = 0;
        A(9,6) = 177/800 + 69/1600*6^(1/2);
        A(9,7) = 177/800 - 69/1600*6^(1/2);
        A(9,8) = -27/800;

        A(10,1) = 2844530829046074022657/58982400000000000000000;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 0;
        A(10,6) = -1598864762333658025459/117964800000000000000000*6^(1/2) + 4287156859652598464203/58982400000000000000000;
        A(10,7) = 1598864762333658025459/117964800000000000000000*6^(1/2) + 4287156859652598464203/58982400000000000000000;
        A(10,8) = -141033886218604337343/6553600000000000000000;
        A(10,9) = -21409264848554971927/204800000000000000000;

        A(11,1) = -72189389771/9959178240000-459663572789/59755069440000*6^(1/2);
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = 0;
        A(11,6) = 1/30;
        A(11,7) = -14201240926266911/557169364500480000-31790792357660029/557169364500480000*6^(1/2);
        A(11,8) = 459663572789/56275107840000*6^(1/2)+22414436941/1563197440000;
        A(11,9) = 459663572789/11403694080000*6^(1/2)+154180604903/2534154240000;
        A(11,10) = 18386542911560000000/1129832575916216250771*6^(1/2)+21871487332435000000/125536952879579583419;

        A(12,1) = -178144571353393080183496267158614821877982611914666395752937745405391408707734804982447062502773/1247718010112994054746145516410425353598134947600568397156373491324203879120405304413829778240000+352591194575569317115651180991223097026568880384478484650944931412648046608828531034562538513357/8110167065734461355849945856667764798387877159403694581516427693607325214282634478689893558560000*sqrt(6);
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = 0;
        A(12,5) = 0;
        A(12,6) = -39115022545645779688585831988975140882502245161831122703201435591036520210945751850583137867/38425428798268102367071108589483043166777031255688218331140907046999467997785653437677908480-490826700396287454540598331961129757400186839154291202145347161815801053957874498846640625/15370171519307240946828443435793217266710812502275287332456362818799787199114261375071163392*sqrt(6);
        A(12,7) = 643210041535328932923955834959360270277930780334485030265105750796567439186095378077346484617022694073/1814903407134118101527330524719997209072721513421672786517822272756721738310655354625038802858212480000*sqrt(6)-622064296680932516193525865473060264652463486635595667447855699920023546211607797417635623004817316459/907451703567059050763665262359998604536360756710836393258911136378360869155327677312519401429106240000;
        A(12,8) = 1203943546728385294644268186854769106596033156989737459970836017592684437096940490927391123081521/6546732431504927940789740125933173479539636700187880198168132038132534360122730704444373657280000-151110511960958278763850506139095613011386663021919350564690684891134877118069370443383945077153/3273366215752463970394870062966586739769818350093940099084066019066267180061365352222186828640000*sqrt(6);
        A(12,9) = 63681466156701378449525903160928961790100434377497936201427140303316098275608362465676059840449/119057634931893490852780569777780769114850167606078444507680127107913165342297705956314829715000-352591194575569317115651180991223097026568880384478484650944931412648046608828531034562538513357/1547749254114615381086147407111149998493052178879019778599841652402871149449870177432092786295000*sqrt(6);
        A(12,10) = -24757946279683404392669266925829425235785590869511266396518921812563538267024485653444025561440747520000000/269185895336262450059330100908971764013929908518190138634918622045026360125733660563690494055892465375982561*sqrt(6)+1027893404876323970566863593065627643827980253781207669195240625566060297608283559817962257983678464000000/2070660733355865000456385391607475107799460834755308758730143246500202770197951235105311492737634349046197;
        A(12,11) = 19635000096509466380843956455829094932847113883632439882926745444809822658280742880787456/15009933124323477487137151792766813737022277834253210285601916815234167186635020874092933;
        
        A(13,1) = -25488511950948766602163761842966272037005387677568247/25343364340644945281003771622773961523200000000000000 + 2525608241949563386308964624438617443527/12416017897756354830807859200000000000000*sqrt(6);
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = 0;
        A(13,5) = 0;
        A(13,6) = -2617546081675469247418718340204655213/431392587109884206933606400000000000 - 552470350996365859393640759989/2400793528263703412500070400000*sqrt(6);
        A(13,7) = -45969294618407232267578352626581642155421231201/10187731154133781589406192186163200000000000000 + 1540493536582818303738906021531546510663696889/885889665576850572991842798796800000000000000*sqrt(6);
        A(13,8) = 203013873418014401588800777489550153682185921397719/6003783517480134311881093736968119910400000000000000 - 3968812951635028178485515838403541696971/18374628007211630439078297600000000000000*sqrt(6);
        A(13,9) = 57340072791914637839492204156400815228449519011392389/19744238839693126186283635091213610188800000000000000 - 677602211254760908521917338264019314117/635714271434389910412902400000000000000*sqrt(6);
        A(13,10) = 24100788715039192225758197856261740786803059875758180717/9662717001210818114953908042643919942065136939286292000 - 8800028717594297513271653743688562521/20449362746897197076153911415852248500*sqrt(6);
        A(13,11) = 124358916033523439225154730110040589545064737/19935912449945669485002510178704400000000000;
        A(13,12) = 594716139297486674475082356103592029886330739685357945223223985387172161751824241784555387316314439/818019847119678359631725769101238313386585208743795596694052943582031156000597320370585600000000000;

        A(14,1) = 184592679361470753674594239208189459317466722387929369596771/127891217091830656233364014205731655064571321600000000000000 - 293880952873230803935166416296767553377/866938749696854853908947200000000000000*sqrt(6);
        A(14,2) = 0;
        A(14,3) = 0;
        A(14,4) = 0;
        A(14,5) = 0;
        A(14,6) = 5966995986367380181027852718263477/684582962942931480729600000000000 + 2897291244884828193281565089/19049265055803310768128000000*sqrt(6);
        A(14,7) = 99009240614446727611594225452277068906413179/16167053833464253010532287404800000000000000 - 3748619435624523040662096435375495632409181/1405830768127326348741938035200000000000000*sqrt(6);
        A(14,8) = 4632645823113234486269357844283603936661991916850927460433/5096189922215990577140952099757378096638035200000000000000 + 41982993267604400562166630899538221911/116635822311401951029305600000000000000*sqrt(6);
        A(14,9) = -12135475677184688070559819501757154968443992507349800863475059/3337534088557268857775113382843672473526974754800000000000000 + 293880952873230803935166416296767553377/165447122399672764770545400000000000000*sqrt(6);
        A(14,10) = -8031428603597180964147750321204281053557209400385686643427859804352/2513586440178391306900178164909088113749933981949109368563389778875 + 21495292553013453087829315020563569618432/29973653446264566614372595657785433238875*sqrt(6);
        A(14,11) = -44866632128961269158599595825347949153517725172080973/5429607175821308141232283339099249860726338769531250;
        A(14,12) = -359988533934752543813368225945058137961504440675167771570563740579175484411998973149563531328527853237660249760109643/234128137445668240736067711662442379892483470931740696615716602345729933343308008758732590194294958617150200000000000;
        A(14,13) = 1011136807359189181222571916914688/2927578889427871359661497484969729;

        A(15,1) = -43117938494612449223384237106139955697243762787772847383/14030104862294690648579566521727488445420965260989440000 + 4220334940168717525563719481764309232553/5553268895030690235789996003491120640000*sqrt(6);
        A(15,2) = 0;
        A(15,3) = 0;
        A(15,4) = 0;
        A(15,5) = 0;
        A(15,6) = -492170504431044248358505817476691843/26311016381549020957251979880325120 - 65372649360291914372644744384375/457582893592156886213077910962176*sqrt(6);
        A(15,7) = -60242025722206083647640080390153021797730167/4671870346091448695506240355969515576320000 + 312292306982904450161582808948983992497619279/54031196176535884913246084116864832317440000*sqrt(6);
        A(15,8) = -10128486019754425336362855829794634260766582925227304979/2051440458733049774272501566471676463052668060718080000 - 4220334940168717525563719481764309232553/5229862652007483519857107084128791040000*sqrt(6);
        A(15,9) = 90164396775224825317874747969895939573106537263617688583/9932194582195572820411492715910530662743409752296080000 - 4220334940168717525563719481764309232553/1059789239915401287502749181781142480000*sqrt(6);
        A(15,10) = 822220421784353922416106346105112190310210366765138782108892460117760000000/112539961436930436130682455392076582934435837857314380718907401253008522853 - 43216229787327667461772487493266526541342720000000/26879922067906624005297106621487120800647611685231*sqrt(6);
        A(15,11) = 209814213871916216679569640811090009729840605120/11651974660960738096987230622554824075229159217;
        A(15,12) = 3941550892863952281184122715485813150214519858148244578543766661999079625453432169420046111603168071904019820197053706993310801913/576348806945747835561749398160966945390916610765210182493857593996732757363976976471505530337022074730630638475548489174498085584;
        A(15,13) = -4759443892077050695292772766912275498897121280000000000/4614026158486489304426198097242323507384603506591241137;
        A(15,14) = 38733614144315448443538220691259283298308750000000/93806291160324220065540465392781147766752569954001;

        A(16,1) = 18092408213832965447840389945226814727838921316097789/4568260908663202892681034746459555501706277524480000 - 156317653995567850184921063401246768027/212359240683067701291661898043594240000*sqrt(6);
        A(16,2) = 0;
        A(16,3) = 0;
        A(16,4) = 0;
        A(16,5) = 0;
        A(16,6) = 65946837846509057750066287355594411/3018431611722608724311451319541760 + 41984484090942118562371132909375/52494462812567108248894805557248*sqrt(6);
        A(16,7) = 8692965898134239206513518248119006769975359/535962614823230784958890847664050959360000 - 38800907634871851557429961190168666395776983/6198524154042582121698476759940763269120000*sqrt(6);
        A(16,8) = 2641630262222426284468500071736583566105608571199325883/235343729805469979809271071241826755571130067491840000 + 156317653995567850184921063401246768027/199992055607259790546219146109360640000*sqrt(6);
        A(16,9) = -193422103474923353694542105476136625982637168991506421/16048357343710211432072833749116213173856151273040000 + 156317653995567850184921063401246768027/40526767661819895652001992553977680000*sqrt(6);
        A(16,10) = -19419587503350096681694941672242361995243037384025897671049255680000000/2155738929233095407456284002740551925607350553898010429805538450410571 + 1600692776914614785893591689228766904596480000000/1027899053306897212338272667278244239283200723671*sqrt(6);
        A(16,11) = -27285760059113968837908932750404506400064658240/1336728621411169422812695849204871581103756891;
        A(16,12) = -194853016061874333335484555436551917329750324944158872786342511110263341294405932910123138589192221578993200454377/15840605894584140753571150900860666508000461134947537749588341642048479030548925808450142813874420689113167632464;
        A(16,13) = 89488735256675489275877211680603518179732480000000000/58814073298029244653337926984054935524805348324518339;
        A(16,14) = 0;
        A(16,15) = 0;

        b(1) = 100976787617015984669475787/6921502952403262310437464576;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 0;
        b(7) = 0;
        b(8) = 8877148253451235588984375/4385514038208782482187638272;
        b(9) = 961916572949681511747758515625/4416417715504587515036809762176;
        b(10) = 1967337516701564001434375000000000000000000000000/15431364863119854943071851131903908575429289017877;
        b(11) = 2323713252076974806855457536/10352378514220126928031114081;
        b(12) = 28308600293241456954311939117138937391141264054325158121088859798090056999504636993802634122671806566061266984631226363619/158391546540670080968065757007173890885877631132509858232987982213169380898029758612356596464561682203552186100842929847264;
        b(13) = 296136352341197653422080000000000000/3899432561650270968394778037550931439;
        b(14) = 117048651891177050452812500000000/903958175807874008864483503817601;
        b(15) = 145778296653275182685983/4945417885871057962703934;
        b(16) = 0;
        
        b_hat(1) = 34542436255316150799031/1697695107285568386175488;
        b_hat(2) = 0;
        b_hat(3) = 0;
        b_hat(4) = 0;
        b_hat(5) = 0;
        b_hat(6) = 0;
        b_hat(7) = 0;
        b_hat(8) = 11089416604965799654140625/10367645480399012960254464;
        b_hat(9) = 19661377435148646805703125/255979697183364488207083392;
        b_hat(10) = 688790393936688343750000000000000000000000/6091295374506475008386869675533556427693991;
        b_hat(11) = 2387113868151976968347648/9351742108599933990994683;
        b_hat(12) = -12428699133337309103655890990808226652772000718643045082918121983471100560973332724469319414156511978021429/12648919237095643063555422745116719205173888728920704277722434371356124846214898200346632677347950735102176;
        b_hat(13) = 185286960316915979617280000000000000/465364379785423284294027008596613217;
        b_hat(14) = 0;
        b_hat(15) = 0;
        b_hat(16) = 16723862451391031122709/339047561915509883967882;
        
        p_order = 9;
        isFSAL = false;
end

stats.n_feval = 0;
stats.n_success_steps = 0;
stats.n_failed_steps = 0;

c = c(:);
b = b(:);
b_hat = b_hat(:);
d = b_hat - b;
z_0 = incond(:);
dzdt = odefun;

s_stages = numel(c);
m = numel(z_0);

t = tspan(1);

zsol = zeros(m, 1); 
K = zeros(m, s_stages);

alpha_safe = 0.7/p_order;
beta_safe = 0.4/p_order;

n = 1;
zsol(:, n) = z_0;
tau(n) = options.MinStepSize;
err(n) = 1;
K(:, 1) = dzdt(t(n), zsol(:, n)); 
stats.n_feval = stats.n_feval + 1;
dzdt_eval(n, :) = K(:, 1);
done = false;

while ~done        
    if t(n) + tau(n) > tspan(2)
        tau(n) = tspan(2) - t(n);
        if tau(n) < eps
            done = true; 
            break; 
        end
    end

    for i = 2:s_stages
        K(:, i) = dzdt( ...
            t(n) + tau(n) * c(i), ...
            zsol(:, n) + tau(n) * K(:, 1:i-1) * A(i, 1:i-1).' ...
        );
        stats.n_feval = stats.n_feval + 1;
    end
    
    zsol(:, n+1) = zsol(:, n) + tau(n) * K * b;
    LTE = tau(n) * K * d;
    err(n+1) = norm(LTE ./ (options.ATol + options.RTol * max(abs(zsol(:, n)), abs(zsol(:, n+1)))), "inf");

    if err(n+1) <= 1
        stats.n_success_steps = stats.n_success_steps + 1;

        if n == 1
            err(n) = err(n+1);
        end

        t(n+1) = t(n) + tau(n);

        factor = options.SafetyFactor * (1 / err(n+1))^alpha_safe;
        % factor = options.SafetyFactor * (1 / error_ratio(n+1))^alpha_safe * (error_ratio(n)/error_ratio(n+1))^beta_safe ;
        factor = min(options.MaxGrowth, max(factor, options.MinGrowth));
        tau(n+1) = min(options.MaxStepSize, max(factor * tau(n), options.MinStepSize));
        n = n + 1;
        if isFSAL
            K(:, 1) = K(:, end);
            dzdt_eval(n, :) = K(:, 1) .';
        else
            K(:, 1) = dzdt(t(n), zsol(:, n));
            dzdt_eval(n, :) = K(:, 1) .';
            stats.n_feval = stats.n_feval + 1;
        end
    else
        stats.n_failed_steps = stats.n_failed_steps + 1;
        factor = options.SafetyFactor * (1 / err(n+1))^alpha_safe;
        factor = min(1, max(factor, options.MinGrowth));

        if factor * tau(n) < options.MinStepSize
            warning('ODE:Underflow', 'Step size underflow at t=%e. Required: %e, Min: %e', t(n), factor * tau(n), options.MinStepSize);
            done = true;
        else
            tau(n) = min(options.MaxStepSize, factor * tau(n));
        end
    end 
end

zsol = zsol .';

t = t(:);
stats.tau_history = tau(:);
stats.error_history = err(:);

end